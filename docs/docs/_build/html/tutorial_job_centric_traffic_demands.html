

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Job-Centric Traffic Demands &mdash; TrafPy 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Load and Rack Configurations" href="tutorial_load_rack_config.html" />
    <link rel="prev" title="Flow-Centric Traffic Demands" href="tutorial_flow_centric_traffic_demands.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> TrafPy
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Install.html">Install</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tutorial.html">Tutorial</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="tutorial_generator.html">TrafPy Generator</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="tutorial_value_distributions.html">Value Distributions</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial_node_distributions.html">Node Distributions</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial_networks.html">Networks</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial_flow_centric_traffic_demands.html">Flow-Centric Traffic Demands</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Job-Centric Traffic Demands</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial_load_rack_config.html">Load and Rack Configurations</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial_visually_shaping_distributions.html">Visually Shaping TrafPy Distributions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_manager.html">TrafPy Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_benchmarker.html">TrafPy Benchmarker</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Contribute.html">Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="License.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="Citing.html">Citing</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">setup module</a></li>
<li class="toctree-l1"><a class="reference internal" href="trafpy.html">trafpy package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TrafPy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="tutorial.html">Tutorial</a> &raquo;</li>
        
          <li><a href="tutorial_generator.html">TrafPy Generator</a> &raquo;</li>
        
      <li>Job-Centric Traffic Demands</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/tutorial_job_centric_traffic_demands.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="job-centric-traffic-demands">
<h1>Job-Centric Traffic Demands<a class="headerlink" href="#job-centric-traffic-demands" title="Permalink to this headline">¶</a></h1>
<p>A job is a task sent to a network (such as a data centre) to execute. Jobs are
computation graphs made up of <strong>operations</strong> (ops). Jobs might be e.g. a Google
search query, generating a user’s Facebook feed, performing a TensorFlow machine
learning task (e.g. backpropagation), etc.</p>
<p>In this context, an op is a data process ran on some machine where the result
is specified by a pre-determined rule/programme. Each op requires &gt;= 0 tensors/data
objects as input, and produces &gt;= tensors as output.</p>
<p>In a job computation graph, if an op v requires &gt;= 1 input(s) produced by op u,
the ops will be connected by a directed edge, [u, v], representing the <strong>dependency</strong>
between the two ops. The edge attributes here are features of the tensor (e.g.
size, source machine, destination machine, etc.).</p>
<p>In a data centre, when a job arrives, each op in the job is placed onto some
machine to execute the op. These ops might be placed all on one machine or, as
is often the case for many applications, spread out across different machines in the network
according to e.g. some heuristic. The <strong>network</strong> is used to pass the tensors around
between the machines executing the ops. These tensors/data objects flowing
between ops are <strong>flows</strong>. The flows of a given job might flow through the network
at the same time or at different times depending on e.g. scheduling decisions, constraints,
dependencies, etc.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In a job graph, edges between ops represent 1 of 2 types of op dependency:</p>
<ul class="simple">
<li><p><strong>Data dependency</strong>: Op j can only begin when op i’s output tensor(s)
have arrived. Therefore, data dependencies become network flows <em>if</em>
op j and op i are ran on separate network endpoints.</p></li>
<li><p><strong>Control dependency</strong>: Op j can only begin when op i has finished.
No data is exchanged, therefore control dependencies never become
network flows.</p></li>
</ul>
</div>
<p>Common job demand characteristics include:</p>
<ul class="simple">
<li><p>job interarrival time;</p></li>
<li><p>which machine each op in the job is placed on;</p></li>
<li><p>number of ops in the job;</p></li>
<li><p>run times of the ops;</p></li>
<li><p>size of data dependencies (flows) between ops;</p></li>
<li><p>ratio of control to data dependencies in job computation graph; and</p></li>
<li><p>connectivity of job graph.</p></li>
</ul>
<p>You can use the same value and node distributions as before to generate realistic
job demands. The only difference is that now you will pass additional arguments
into <code class="xref py py-func docutils literal notranslate"><span class="pre">tpg.create_demand_data()</span></code>. TrafPy will respond by generating job computation graphs
rather than flows as the demands in the returned dictionary.</p>
<p>Consider that you want to create 10 realistic data centre jobs in the same simple
5-node network as before (but now omitting <code class="docutils literal notranslate"><span class="pre">show_fig</span></code> to save page space).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">num_demands</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tpg</span><span class="o">.</span><span class="n">gen_simple_network</span><span class="p">(</span><span class="n">ep_label</span><span class="o">=</span><span class="s1">&#39;endpoint&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>You could start by definiing the flow size distribution of the flows inside the
job graphs</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">flow_size_dist</span> <span class="o">=</span> <span class="n">tpg</span><span class="o">.</span><span class="n">gen_multimodal_val_dist</span><span class="p">(</span><span class="n">min_val</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">max_val</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">locations</span><span class="o">=</span><span class="p">[</span><span class="mi">50</span><span class="p">],</span><span class="n">skews</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">scales</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span><span class="n">num_skew_samples</span><span class="o">=</span><span class="p">[</span><span class="mi">10000</span><span class="p">],</span><span class="n">bg_factor</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">round_to_nearest</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">num_bins</span><span class="o">=</span><span class="mi">34</span><span class="p">)</span>
</pre></div>
</div>
<p>then the job interarrival time distribution</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">interarrival_time_dist</span> <span class="o">=</span> <span class="n">tpg</span><span class="o">.</span><span class="n">gen_multimodal_val_dist</span><span class="p">(</span><span class="n">min_val</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">max_val</span><span class="o">=</span><span class="mf">1e8</span><span class="p">,</span><span class="n">locations</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3000</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1800000</span><span class="p">,</span><span class="mi">10000000</span><span class="p">],</span><span class="n">skews</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span><span class="n">scales</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">62</span><span class="p">,</span><span class="mi">2000</span><span class="p">,</span><span class="mi">7500</span><span class="p">,</span><span class="mi">3500000</span><span class="p">,</span><span class="mi">20000000</span><span class="p">],</span><span class="n">num_skew_samples</span><span class="o">=</span><span class="p">[</span><span class="mi">800</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">2000</span><span class="p">,</span><span class="mi">4000</span><span class="p">,</span><span class="mi">4000</span><span class="p">,</span><span class="mi">3000</span><span class="p">],</span><span class="n">bg_factor</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span><span class="n">round_to_nearest</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>then the number of ops in each job</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">num_ops_dist</span> <span class="o">=</span> <span class="n">tpg</span><span class="o">.</span><span class="n">gen_multimodal_val_dist</span><span class="p">(</span><span class="n">min_val</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">max_val</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">locations</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">],</span><span class="n">skews</span><span class="o">=</span><span class="p">[</span><span class="mf">0.05</span><span class="p">],</span><span class="n">scales</span><span class="o">=</span><span class="p">[</span><span class="mi">50</span><span class="p">],</span><span class="n">num_skew_samples</span><span class="o">=</span><span class="p">[</span><span class="mi">10000</span><span class="p">],</span><span class="n">bg_factor</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span><span class="n">round_to_nearest</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>and then the source-destination node (i.e. op machine placement) distribution</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">endpoints</span> <span class="o">=</span> <span class="n">network</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s1">&#39;endpoints&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">node_dist</span> <span class="o">=</span> <span class="n">tpg</span><span class="o">.</span><span class="n">gen_multimodal_node_dist</span><span class="p">(</span><span class="n">eps</span><span class="o">=</span><span class="n">endpoints</span><span class="p">,</span><span class="n">num_skewed_nodes</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>You can then use your distributions to generate your job-centric demand data
returned neatly into a single dictionary</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">job_centric_demand_data</span> <span class="o">=</span> <span class="n">tpg</span><span class="o">.</span><span class="n">create_demand_data</span><span class="p">(</span><span class="n">num_demands</span><span class="o">=</span><span class="n">num_demands</span><span class="p">,</span><span class="n">eps</span><span class="o">=</span><span class="n">endpoints</span><span class="p">,</span><span class="n">node_dist</span><span class="o">=</span><span class="n">node_dist</span><span class="p">,</span><span class="n">flow_size_dist</span><span class="o">=</span><span class="n">flow_size_dist</span><span class="p">,</span><span class="n">interarrival_time_dist</span><span class="o">=</span><span class="n">interarrival_time_dist</span><span class="p">,</span><span class="n">num_ops_dist</span><span class="o">=</span><span class="n">num_ops_dist</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span><span class="n">use_multiprocessing</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Don’t forget to save your data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tpg</span><span class="o">.</span><span class="n">pickle_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">job_centric_demand_data</span><span class="p">,</span><span class="n">path_to_save</span><span class="o">=</span><span class="s1">&#39;data/job_centric_demand_data.pickle&#39;</span><span class="p">,</span><span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">zip_data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>TrafPy job-centric demand data dictionaries are organised as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;job_id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;job_0&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s1">&#39;job_n&#39;</span><span class="p">],</span>
    <span class="s1">&#39;job&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">networkx_graph_job_0</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">networkx_graph_job_n</span><span class="p">],</span>
    <span class="s1">&#39;event_time&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">event_time_job_0</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">event_time_job_n</span><span class="p">],</span>
    <span class="s1">&#39;establish&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">event_establish_job_0</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">event_establish_job_1</span><span class="p">],</span>
    <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">index_job_0</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">index_job_1</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Where the <code class="docutils literal notranslate"><span class="pre">'job'</span></code> key contains the list of job computation graphs with all
the embedded demand data. You can visualise the job computation graph(s):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">jobs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">job_centric_demand_data</span><span class="p">[</span><span class="s1">&#39;job&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">tpg</span><span class="o">.</span><span class="n">draw_job_graphs</span><span class="p">(</span><span class="n">job_graphs</span><span class="o">=</span><span class="n">jobs</span><span class="p">,</span><span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/job_graph_1.png" class="align-center" src="_images/job_graph_1.png" />
<img alt="_images/job_graph_2.png" class="align-center" src="_images/job_graph_2.png" />
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tutorial_load_rack_config.html" class="btn btn-neutral float-right" title="Load and Rack Configurations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="tutorial_flow_centric_traffic_demands.html" class="btn btn-neutral float-left" title="Flow-Centric Traffic Demands" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Christopher W. F. Parsonson

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>