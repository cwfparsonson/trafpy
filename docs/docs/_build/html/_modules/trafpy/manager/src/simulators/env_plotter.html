

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>trafpy.manager.src.simulators.env_plotter &mdash; TrafPy 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/underscore.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
        <script src="../../../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../../index.html" class="icon icon-home"> TrafPy
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../Install.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../Contribute.html">Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../License.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../Citing.html">Citing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../setup.html">setup module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../trafpy.html">trafpy package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">TrafPy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../../index.html">Module code</a> &raquo;</li>
        
      <li>trafpy.manager.src.simulators.env_plotter</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for trafpy.manager.src.simulators.env_plotter</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">from</span> <span class="nn">sqlitedict</span> <span class="kn">import</span> <span class="n">SqliteDict</span>
<span class="kn">from</span> <span class="nn">trafpy.generator.src.dists</span> <span class="kn">import</span> <span class="n">plot_dists</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span> <span class="c1"># use for initialising arbitrary length nested dict</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">statistics</span> <span class="kn">import</span> <span class="n">mean</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">chain</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sigfig</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">from</span> <span class="nn">sqlitedict</span> <span class="kn">import</span> <span class="n">SqliteDict</span>
<span class="kn">import</span> <span class="nn">os</span>


<div class="viewcode-block" id="EnvPlotter"><a class="viewcode-back" href="../../../../../trafpy.manager.src.simulators.html#trafpy.manager.src.simulators.env_plotter.EnvPlotter">[docs]</a><span class="k">class</span> <span class="nc">EnvPlotter</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>


    <span class="k">def</span> <span class="nf">_check_analyser_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">analyser</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="n">analyser</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Must instantiate EnvAnalyser class before passing to EnvPlotter.&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">analyser</span><span class="o">.</span><span class="n">computed_metrics</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Must compute metrics with EnvAnalyser.compute_metrics() before passing to EnvPlotter.&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_summary_dict"><a class="viewcode-back" href="../../../../../trafpy.manager.src.simulators.html#trafpy.manager.src.simulators.env_plotter.get_summary_dict">[docs]</a><span class="k">def</span> <span class="nf">get_summary_dict</span><span class="p">(</span><span class="n">analysers</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">time_units</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">info_units</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="n">summary_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">header</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">analyser</span> <span class="ow">in</span> <span class="n">analysers</span><span class="p">:</span>
        <span class="c1"># self._check_analyser_valid(analyser)</span>
        <span class="n">summary_dict</span><span class="p">[</span><span class="s1">&#39;Load&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">summary_dict</span><span class="p">[</span><span class="s1">&#39;Subject&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">)</span>
        <span class="n">summary_dict</span><span class="p">[</span><span class="s1">&#39;T-Score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">t_score</span><span class="p">)</span>
        <span class="n">summary_dict</span><span class="p">[</span><span class="s1">&#39;Mean FCT (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time_units</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">mean_fct</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">summary_dict</span><span class="p">[</span><span class="s1">&#39;p99 FCT (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time_units</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">nn_fct</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">summary_dict</span><span class="p">[</span><span class="s1">&#39;Max FCT (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time_units</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">max_fct</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">summary_dict</span><span class="p">[</span><span class="s1">&#39;Throughput&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sigfig</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">throughput_frac</span><span class="p">),</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">6</span><span class="p">))</span>
        <span class="n">summary_dict</span><span class="p">[</span><span class="s1">&#39;Throughput (</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">info_units</span><span class="p">,</span> <span class="n">time_units</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sigfig</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">throughput_abs</span><span class="p">),</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">6</span><span class="p">))</span>
        <span class="n">summary_dict</span><span class="p">[</span><span class="s1">&#39;Frac Flows Accepted&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sigfig</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">analyser</span><span class="o">.</span><span class="n">dropped_flow_frac</span><span class="p">),</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">6</span><span class="p">))</span>
        <span class="n">summary_dict</span><span class="p">[</span><span class="s1">&#39;Frac Info Accepted&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sigfig</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">analyser</span><span class="o">.</span><span class="n">dropped_info_frac</span><span class="p">),</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">6</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">analyser</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">job_centric</span><span class="p">:</span>
            <span class="n">summary_dict</span><span class="p">[</span><span class="s1">&#39;Mean JCT (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time_units</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">mean_jct</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">summary_dict</span><span class="p">[</span><span class="s1">&#39;p99 JCT (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time_units</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">nn_jct</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">summary_dict</span><span class="p">[</span><span class="s1">&#39;Max JCT (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time_units</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">max_jct</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">summary_dict</span><span class="p">[</span><span class="s1">&#39;Frac Jobs Accepted&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sigfig</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">analyser</span><span class="o">.</span><span class="n">dropped_job_frac</span><span class="p">),</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">6</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">summary_dict</span></div>

<div class="viewcode-block" id="EnvsPlotter"><a class="viewcode-back" href="../../../../../trafpy.manager.src.simulators.html#trafpy.manager.src.simulators.env_plotter.EnvsPlotter">[docs]</a><span class="k">class</span> <span class="nc">EnvsPlotter</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_units</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">info_units</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">path_to_save</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_units</span> <span class="o">=</span> <span class="n">time_units</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info_units</span> <span class="o">=</span> <span class="n">info_units</span>

        <span class="k">if</span> <span class="n">path_to_save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">folder_name</span> <span class="o">=</span> <span class="n">path_to_save</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># want unique to make copying to local machine easier across multiple envs_plotter folders</span>
            <span class="n">path_to_save</span> <span class="o">=</span> <span class="n">path_to_save</span> <span class="o">+</span> <span class="s1">&#39;/envs_plotter_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">folder_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path_to_save</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">path_to_save</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span> <span class="o">=</span> <span class="n">path_to_save</span>


    <span class="k">def</span> <span class="nf">_group_analyser_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">analysers</span><span class="p">):</span>
        <span class="n">classes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">analyser</span> <span class="ow">in</span> <span class="n">analysers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">:</span>
                <span class="n">classes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">classes</span>

    <span class="k">def</span> <span class="nf">_check_analyser_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">analyser</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="n">analyser</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Must instantiate EnvAnalyser class before passing to EnvPlotter.&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">analyser</span><span class="o">.</span><span class="n">computed_metrics</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Must compute metrics with EnvAnalyser.compute_metrics() before passing to EnvPlotter.&#39;</span><span class="p">)</span>



    <span class="c1">############################### GENERIC #################################</span>

<div class="viewcode-block" id="EnvsPlotter.construct_tables"><a class="viewcode-back" href="../../../../../trafpy.manager.src.simulators.html#trafpy.manager.src.simulators.env_plotter.EnvsPlotter.construct_tables">[docs]</a>    <span class="k">def</span> <span class="nf">construct_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">analysers</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Constructs summary dataframes and tables and (optionally) prints out</span>
<span class="sd">        and displays these tables. Optionally also visualises these summary</span>
<span class="sd">        data with radar plots.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;display_tables&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;display_tables&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s1">&#39;plot_radar&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;plot_radar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s1">&#39;figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">12.8</span><span class="p">,</span> <span class="mf">9.6</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;font_size&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="k">if</span> <span class="s1">&#39;fill_alpha&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;fill_alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.05</span>
        <span class="k">if</span> <span class="s1">&#39;print_latex_tables&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;print_latex_tables&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># path to write excel tables to</span>

        <span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Load&#39;</span><span class="p">,</span> 
                   <span class="s1">&#39;Subject&#39;</span><span class="p">,</span> 
                   <span class="s1">&#39;T-Score&#39;</span><span class="p">,</span> 
                   <span class="s1">&#39;Mean FCT (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_units</span><span class="p">),</span> 
                   <span class="s1">&#39;p99 FCT (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_units</span><span class="p">),</span> 
                   <span class="s1">&#39;Max FCT (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_units</span><span class="p">),</span> 
                   <span class="s1">&#39;Throughput&#39;</span><span class="p">,</span> 
                   <span class="s1">&#39;Throughput (</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">info_units</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_units</span><span class="p">),</span>
                   <span class="s1">&#39;Frac Flows Accepted&#39;</span><span class="p">,</span> 
                   <span class="s1">&#39;Frac Info Accepted&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">analyser</span> <span class="ow">in</span> <span class="n">analysers</span><span class="p">:</span>
            <span class="n">job_centric</span> <span class="o">=</span> <span class="n">analyser</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">job_centric</span>
            <span class="k">break</span>
        <span class="k">if</span> <span class="n">job_centric</span><span class="p">:</span>
            <span class="n">headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Mean JCT (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_units</span><span class="p">))</span>
            <span class="n">headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;p99 JCT (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_units</span><span class="p">))</span>
            <span class="n">headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Max JCT (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_units</span><span class="p">))</span>
            <span class="n">headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Frac Jobs Accepted&#39;</span><span class="p">)</span>


        <span class="n">_summary_dict</span> <span class="o">=</span> <span class="n">get_summary_dict</span><span class="p">(</span><span class="n">analysers</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">time_units</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">time_units</span><span class="p">,</span> <span class="n">info_units</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">info_units</span><span class="p">)</span>

        <span class="c1"># sort by order of load</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">_summary_dict</span><span class="p">[</span><span class="s1">&#39;Load&#39;</span><span class="p">])</span>
        <span class="n">summary_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">_summary_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">summary_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">_summary_dict</span><span class="p">[</span><span class="n">key</span><span class="p">])[</span><span class="n">index</span><span class="p">]</span>
        <span class="c1"># print(summary_dict)</span>

        <span class="c1"># sort loads by subject name (alphabetical)</span>
        <span class="n">sorted_summary_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">header</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">}</span>
        <span class="c1"># create winner table</span>
        <span class="n">winner_table</span> <span class="o">=</span> <span class="p">{</span><span class="n">header</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">headers</span> <span class="k">if</span> <span class="n">header</span> <span class="o">!=</span> <span class="s1">&#39;T-Score&#39;</span> <span class="ow">and</span> <span class="n">header</span> <span class="o">!=</span> <span class="s1">&#39;Subject&#39;</span> <span class="ow">and</span> <span class="s1">&#39;Throughput (&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">header</span><span class="p">}</span>
        <span class="n">winner_table</span><span class="p">[</span><span class="s1">&#39;Load&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">summary_dict</span><span class="p">[</span><span class="s1">&#39;Load&#39;</span><span class="p">])))</span>
        <span class="c1"># create ranking table</span>
        <span class="n">ranking_table</span> <span class="o">=</span> <span class="p">{</span><span class="n">header</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">headers</span> <span class="k">if</span> <span class="n">header</span> <span class="o">!=</span> <span class="s1">&#39;T-Score&#39;</span> <span class="ow">and</span> <span class="n">header</span> <span class="o">!=</span> <span class="s1">&#39;Subject&#39;</span> <span class="ow">and</span> <span class="s1">&#39;Throughput (&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">header</span><span class="p">}</span>
        <span class="n">ranking_table</span><span class="p">[</span><span class="s1">&#39;Load&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">summary_dict</span><span class="p">[</span><span class="s1">&#39;Load&#39;</span><span class="p">])))</span>
        <span class="c1"># create excel tables</span>
        <span class="c1"># excel_summary_table = {header: {subject: [] for subject in np.unique(list(summary_dict[&#39;Subject&#39;]))} for header in headers if header != &#39;T-Score&#39; and header != &#39;Subject&#39;}</span>
        <span class="c1"># excel_summary_table[&#39;Load&#39;] = list(np.unique(list(summary_dict[&#39;Load&#39;])))</span>
        <span class="c1"># excel_ranking_table = {header: {subject: [] for subject in np.unique(list(summary_dict[&#39;Subject&#39;]))} for header in headers if header != &#39;T-Score&#39; and header != &#39;Subject&#39;}</span>
        <span class="c1"># excel_ranking_table[&#39;Load&#39;] = list(np.unique(list(summary_dict[&#39;Load&#39;])))</span>
        <span class="n">latex_winner_table</span> <span class="o">=</span> <span class="p">{</span><span class="n">header</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">headers</span> <span class="k">if</span> <span class="n">header</span> <span class="o">!=</span> <span class="s1">&#39;T-Score&#39;</span> <span class="ow">and</span> <span class="n">header</span> <span class="o">!=</span> <span class="s1">&#39;Subject&#39;</span> <span class="ow">and</span> <span class="s1">&#39;Throughput (&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">header</span><span class="p">}</span>
        <span class="n">latex_winner_table</span><span class="p">[</span><span class="s1">&#39;Load&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">summary_dict</span><span class="p">[</span><span class="s1">&#39;Load&#39;</span><span class="p">])))</span>

        <span class="n">num_loads</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">summary_dict</span><span class="p">[</span><span class="s1">&#39;Load&#39;</span><span class="p">])))</span>
        <span class="n">num_subjects</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">summary_dict</span><span class="p">[</span><span class="s1">&#39;Subject&#39;</span><span class="p">])))</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># for indexing each row in summary_dict</span>
        <span class="n">i2</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># for indexing the first instance of a new load row in summary_dict</span>
        <span class="n">nested_dict</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">nested_dict</span><span class="p">)</span>
        <span class="n">plot_dicts</span> <span class="o">=</span> <span class="p">[</span><span class="n">nested_dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_loads</span><span class="p">)]</span>
        <span class="c1"># determine if higher is better for each header</span>
        <span class="n">is_higher_better</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">header</span> <span class="o">==</span> <span class="s1">&#39;T-Score&#39;</span> <span class="ow">or</span> <span class="s1">&#39;Throughput&#39;</span> <span class="ow">in</span> <span class="n">header</span> <span class="ow">or</span> <span class="s1">&#39;Accepted&#39;</span> <span class="ow">in</span> <span class="n">header</span><span class="p">:</span>
                <span class="n">is_higher_better</span><span class="p">[</span><span class="n">header</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">is_higher_better</span><span class="p">[</span><span class="n">header</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># for load_idx in range(num_loads+1):</span>
        <span class="k">for</span> <span class="n">load_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_loads</span><span class="p">):</span>
            <span class="c1"># sort subjects for this load </span>

            <span class="c1"># find num_subjects for each load</span>
            <span class="n">num_subjects</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">loads</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">while</span> <span class="n">summary_dict</span><span class="p">[</span><span class="s1">&#39;Load&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">loads</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">loads</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">loads</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">summary_dict</span><span class="p">[</span><span class="s1">&#39;Load&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
                <span class="n">num_subjects</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">summary_dict</span><span class="p">[</span><span class="s1">&#39;Load&#39;</span><span class="p">]):</span>
                    <span class="c1"># reached end of table</span>
                    <span class="k">break</span>
            <span class="c1"># print(&#39;\nloads: {} | num subjects: {}&#39;.format(loads, num_subjects))</span>

            <span class="c1"># load_t_scores = summary_dict[&#39;T-Score&#39;][i2:i2+num_subjects]</span>
            <span class="c1"># load_t_score_indices = list(reversed(np.argsort(load_t_scores)))</span>
            <span class="c1"># load_t_score_indices = [i2+_i for _i in load_t_score_indices]</span>
            <span class="c1"># print(&#39;t scores: {} | t score indices: {}&#39;.format(load_t_scores, load_t_score_indices))</span>
            <span class="n">subjects</span> <span class="o">=</span> <span class="n">summary_dict</span><span class="p">[</span><span class="s1">&#39;Subject&#39;</span><span class="p">][</span><span class="n">i2</span><span class="p">:</span><span class="n">i2</span><span class="o">+</span><span class="n">num_subjects</span><span class="p">]</span>
            <span class="n">load_subject_indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">subjects</span><span class="p">))</span>
            <span class="n">load_subject_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">i2</span><span class="o">+</span><span class="n">_i</span> <span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="n">load_subject_indices</span><span class="p">]</span>

            <span class="c1"># index by this order</span>
            <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">:</span>
                <span class="c1"># update sorted summary dict</span>
                <span class="n">sorted_summary_dict</span><span class="p">[</span><span class="n">header</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">summary_dict</span><span class="p">[</span><span class="n">header</span><span class="p">][</span><span class="n">load_subject_indices</span><span class="p">])</span>
                
                <span class="c1"># print(&#39;sorted summary dict:\n{}&#39;.format(sorted_summary_dict))</span>

                <span class="c1"># update radar plot &amp; winner table</span>
                <span class="k">if</span> <span class="n">header</span> <span class="o">!=</span> <span class="s1">&#39;Subject&#39;</span> <span class="ow">and</span> <span class="n">header</span> <span class="o">!=</span> <span class="s1">&#39;Load&#39;</span> <span class="ow">and</span> <span class="n">header</span> <span class="o">!=</span> <span class="s1">&#39;T-Score&#39;</span> <span class="ow">and</span> <span class="s1">&#39;Throughput (&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">header</span> <span class="ow">and</span> <span class="n">load_idx</span> <span class="o">&lt;</span> <span class="n">num_loads</span><span class="p">:</span>
                    <span class="c1"># get classes and corresponding rand var values for this rand var</span>
                    <span class="n">classes</span> <span class="o">=</span> <span class="n">summary_dict</span><span class="p">[</span><span class="s1">&#39;Subject&#39;</span><span class="p">][</span><span class="n">load_subject_indices</span><span class="p">]</span>
                    <span class="n">classes_rand_vars</span> <span class="o">=</span> <span class="n">summary_dict</span><span class="p">[</span><span class="n">header</span><span class="p">][</span><span class="n">load_subject_indices</span><span class="p">]</span>
                    <span class="c1"># print(&#39;classes: {} | classes rand vars: {}&#39;.format(classes, classes_rand_vars))</span>

                    <span class="c1"># winner table</span>
                    <span class="k">if</span> <span class="n">is_higher_better</span><span class="p">[</span><span class="n">header</span><span class="p">]:</span>
                        <span class="c1"># max val wins</span>
                        <span class="n">winner_val</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">classes_rand_vars</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># min val wins</span>
                        <span class="n">winner_val</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">classes_rand_vars</span><span class="p">)</span>
                    <span class="n">winner_indices</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">u</span> <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">classes_rand_vars</span><span class="p">)</span> <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="n">winner_val</span><span class="p">])</span>
                    <span class="n">winner</span> <span class="o">=</span> <span class="n">classes</span><span class="p">[</span><span class="n">winner_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">winner_indices</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">winner_idx</span> <span class="ow">in</span> <span class="n">winner_indices</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                            <span class="n">winner</span> <span class="o">=</span> <span class="n">winner</span> <span class="o">+</span> <span class="s1">&#39;+&#39;</span> <span class="o">+</span> <span class="n">classes</span><span class="p">[</span><span class="n">winner_idx</span><span class="p">]</span>
                    <span class="n">winner_table</span><span class="p">[</span><span class="n">header</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">winner</span><span class="p">)</span>


                    <span class="c1"># ranking table</span>
                    <span class="k">if</span> <span class="n">is_higher_better</span><span class="p">[</span><span class="n">header</span><span class="p">]:</span>
                        <span class="c1"># max values better</span>
                        <span class="n">ranking_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">classes_rand_vars</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># low values better</span>
                        <span class="n">ranking_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">classes_rand_vars</span><span class="p">)</span>
                    <span class="n">ranking_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">classes_rand_vars</span><span class="p">)[</span><span class="n">ranking_indices</span><span class="p">]</span>
                    <span class="n">ranking_classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">classes</span><span class="p">)[</span><span class="n">ranking_indices</span><span class="p">]</span>
                    <span class="c1"># find loser -&gt; make this baseline</span>
                    <span class="n">baseline_val</span><span class="p">,</span> <span class="n">baseline_class</span> <span class="o">=</span> <span class="n">ranking_vals</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">ranking_classes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="c1"># find performance improvement of other classes relative to baseline</span>
                    <span class="n">relative_performance</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">ranking_vals</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">diff</span> <span class="o">=</span> <span class="n">val</span> <span class="o">-</span> <span class="n">baseline_val</span>
                        <span class="k">if</span> <span class="n">diff</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">perf</span> <span class="o">=</span> <span class="n">sigfig</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">float</span><span class="p">((</span><span class="n">diff</span><span class="o">/</span><span class="n">baseline_val</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">),</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="c1"># same performance as baseline val</span>
                            <span class="n">perf</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="n">relative_performance</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">perf</span><span class="p">)</span>
                    <span class="n">relative_performance_iterator</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">relative_performance</span><span class="p">)</span>
                    <span class="n">ranks</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                    <span class="k">for</span> <span class="n">_class</span> <span class="ow">in</span> <span class="n">ranking_classes</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">rank</span> <span class="o">=</span> <span class="n">_class</span> <span class="o">+</span> <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">%) | &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sigfig</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">relative_performance_iterator</span><span class="p">),</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
                        <span class="n">ranks</span> <span class="o">+=</span> <span class="n">rank</span>
                    <span class="n">ranks</span> <span class="o">+=</span> <span class="n">baseline_class</span>
                    <span class="n">ranking_table</span><span class="p">[</span><span class="n">header</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ranks</span><span class="p">)</span>

                    <span class="c1"># add winner w/ relative performance to excel winner table</span>
                    <span class="c1"># winner = ranking_classes[0]</span>
                    <span class="n">perf</span> <span class="o">=</span> <span class="n">relative_performance</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">latex_winner_table</span><span class="p">[</span><span class="n">header</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">%&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">winner</span><span class="p">,</span> <span class="n">perf</span><span class="p">))</span>

                    <span class="c1"># # sort ranking classes by alphabet and add to excel ranking table</span>
                    <span class="c1"># excel_indices = np.argsort(ranking_classes[:-1])</span>
                    <span class="c1"># relative_performance_iterator = iter(np.asarray(relative_performance)[excel_indices])</span>
                    <span class="c1"># for _class in np.asarray(ranking_classes[:-1])[excel_indices]:</span>
                        <span class="c1"># excel_ranking_table[header][_class].append(next(relative_performance_iterator))</span>
                    <span class="c1"># excel_ranking_table[header][baseline_class].append(0)</span>
                    

                    <span class="c1"># excel summary table</span>
                    <span class="c1"># excel_indices = np.argsort(classes)</span>
                    <span class="c1"># for _class, val in zip(np.asarray(classes)[excel_indices], np.asarray(classes_rand_vars)[excel_indices]):</span>
                        <span class="c1"># excel_summary_table[header][_class].append(val)</span>
                        







                    <span class="c1"># radar plot</span>
                    <span class="c1"># get min max range</span>
                    <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">classes_rand_vars</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">classes_rand_vars</span><span class="p">)</span>
                    <span class="n">diff</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_val</span> <span class="o">-</span> <span class="n">min_val</span><span class="p">,</span> <span class="mf">1e-9</span><span class="p">)</span>
                    <span class="n">min_val</span> <span class="o">-=</span> <span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="n">diff</span><span class="p">)</span>
                    <span class="n">max_val</span> <span class="o">+=</span> <span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="n">diff</span><span class="p">)</span>
                    <span class="n">_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">]</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_higher_better</span><span class="p">[</span><span class="n">header</span><span class="p">]:</span>
                        <span class="c1"># want lower (better) values on outer radar edge -&gt; flip range</span>
                        <span class="n">_range</span> <span class="o">=</span> <span class="n">_range</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                    <span class="n">plot_dicts</span><span class="p">[</span><span class="n">load_idx</span><span class="p">][</span><span class="n">header</span><span class="p">][</span><span class="s1">&#39;range&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_range</span>
                    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">_class</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">classes</span><span class="p">):</span>
                        <span class="n">plot_dicts</span><span class="p">[</span><span class="n">load_idx</span><span class="p">][</span><span class="n">header</span><span class="p">][</span><span class="s1">&#39;classes&#39;</span><span class="p">][</span><span class="n">_class</span><span class="p">]</span> <span class="o">=</span> <span class="n">classes_rand_vars</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

            <span class="n">i2</span> <span class="o">+=</span> <span class="n">num_subjects</span> 

        <span class="c1"># change headers of winner table to appropriate headers</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">latex_winner_table</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="n">new_key</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="s1">&#39;Mean&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="n">new_key</span> <span class="o">=</span> <span class="s1">&#39;Mean FCT&#39;</span>
            <span class="k">elif</span> <span class="s1">&#39;p99&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="n">new_key</span> <span class="o">=</span> <span class="s1">&#39;p99 FCT&#39;</span>
            <span class="k">elif</span> <span class="s1">&#39;Max&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="n">new_key</span> <span class="o">=</span> <span class="s1">&#39;Max FCT&#39;</span>
            <span class="k">elif</span> <span class="s1">&#39;Throughput Frac&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="n">new_key</span> <span class="o">=</span> <span class="s1">&#39;Throughput&#39;</span>
            <span class="k">elif</span> <span class="s1">&#39;Throughput (&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="n">new_key</span> <span class="o">=</span> <span class="s1">&#39;Throughput Rate&#39;</span>
            <span class="k">elif</span> <span class="s1">&#39;Flows Accepted&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="n">new_key</span> <span class="o">=</span> <span class="s1">&#39;Flows Accepted&#39;</span>
            <span class="k">elif</span> <span class="s1">&#39;Info Accepted&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="n">new_key</span> <span class="o">=</span> <span class="s1">&#39;Info Accepted&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># don&#39;t need to adjust</span>
                <span class="k">pass</span>
            <span class="k">if</span> <span class="n">new_key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">new_key</span> <span class="o">!=</span> <span class="s1">&#39;Throughput Rate&#39;</span><span class="p">:</span>
                <span class="n">latex_winner_table</span><span class="p">[</span><span class="n">new_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">latex_winner_table</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

        <span class="c1"># change headers of latex summary table</span>
        <span class="n">latex_summary_table</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">sorted_summary_dict</span><span class="p">)</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">latex_summary_table</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="n">new_key</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="s1">&#39;Mean&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="n">new_key</span> <span class="o">=</span> <span class="s1">&#39;Mean FCT ($\mu$s)&#39;</span>
            <span class="k">elif</span> <span class="s1">&#39;p99&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="n">new_key</span> <span class="o">=</span> <span class="s1">&#39;p99 FCT ($\mu$s)&#39;</span>
            <span class="k">elif</span> <span class="s1">&#39;Max&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="n">new_key</span> <span class="o">=</span> <span class="s1">&#39;Max FCT ($\mu$s)&#39;</span>
            <span class="k">elif</span> <span class="s1">&#39;Throughput&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="n">new_key</span> <span class="o">=</span> <span class="s1">&#39;Throughput (Frac)&#39;</span>
            <span class="k">elif</span> <span class="s1">&#39;Throughput (&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="n">new_key</span> <span class="o">=</span> <span class="s1">&#39;Throughput Rate (B/$\mu$s)&#39;</span>
            <span class="k">elif</span> <span class="s1">&#39;Flows Accepted&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="n">new_key</span> <span class="o">=</span> <span class="s1">&#39;Flows Accepted (Frac)&#39;</span>
            <span class="k">elif</span> <span class="s1">&#39;Info Accepted&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="n">new_key</span> <span class="o">=</span> <span class="s1">&#39;Info Accepted (Frac)&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># don&#39;t need to adjust</span>
                <span class="k">pass</span>
            <span class="k">if</span> <span class="n">new_key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">latex_summary_table</span><span class="p">[</span><span class="n">new_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">latex_summary_table</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">latex_summary_table</span><span class="p">[</span><span class="s1">&#39;T-Score&#39;</span><span class="p">]</span>
            
             
        <span class="n">summary_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">sorted_summary_dict</span><span class="p">)</span>
        <span class="n">winner_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">winner_table</span><span class="p">)</span>
        <span class="n">ranking_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">ranking_table</span><span class="p">)</span>
        <span class="n">latex_summary_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">latex_summary_table</span><span class="p">)</span>
        <span class="n">latex_winner_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">latex_winner_table</span><span class="p">)</span>


        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;print_latex_tables&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">Summary latex table:&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">latex_summary_dataframe</span><span class="o">.</span><span class="n">to_latex</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">multicolumn</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">escape</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">Winner latex table:&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">latex_winner_dataframe</span><span class="o">.</span><span class="n">to_latex</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">multicolumn</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">summary_dataframe</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/summary_dataframe.pkl&#39;</span><span class="p">)</span>
            <span class="n">latex_summary_dataframe</span><span class="o">.</span><span class="n">to_latex</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">multicolumn</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">buf</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/latex_summary_table&#39;</span><span class="p">,</span> <span class="n">escape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">latex_winner_dataframe</span><span class="o">.</span><span class="n">to_latex</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">multicolumn</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">buf</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/latex_winner_table&#39;</span><span class="p">,</span> <span class="n">escape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Saved tables and dataframes to </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="p">))</span>



        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;display_tables&#39;</span><span class="p">]:</span>
            <span class="n">display</span><span class="p">(</span><span class="n">summary_dataframe</span><span class="p">)</span>
            <span class="n">display</span><span class="p">(</span><span class="n">winner_dataframe</span><span class="p">)</span>
            <span class="n">display</span><span class="p">(</span><span class="n">ranking_dataframe</span><span class="p">)</span>
            <span class="c1"># display(excel_summary_dataframe)</span>
            <span class="c1"># display(excel_ranking_dataframe)</span>
            <span class="c1"># display(latex_winner_dataframe)</span>

        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;plot_radar&#39;</span><span class="p">]:</span>
            <span class="n">loads</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">summary_dict</span><span class="p">[</span><span class="s1">&#39;Load&#39;</span><span class="p">])))</span>
            <span class="k">for</span> <span class="n">plot_dict</span> <span class="ow">in</span> <span class="n">plot_dicts</span><span class="p">:</span>
                <span class="c1"># if len(list(plot_dict.keys())) != 0:</span>
                <span class="n">load</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">loads</span><span class="p">)</span>
                <span class="n">radar</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_radar</span><span class="p">(</span><span class="n">plot_dict</span><span class="p">,</span> 
                                              <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Load </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">load</span><span class="p">),</span> 
                                              <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;figsize&#39;</span><span class="p">],</span>
                                              <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                              <span class="n">fill_alpha</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;fill_alpha&#39;</span><span class="p">],</span>
                                              <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">radar</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/radar_load_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">load</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>


        <span class="k">return</span> <span class="n">summary_dataframe</span><span class="p">,</span> <span class="n">winner_dataframe</span><span class="p">,</span> <span class="n">ranking_dataframe</span></div>


<div class="viewcode-block" id="EnvsPlotter.plot_t_score_scatter"><a class="viewcode-back" href="../../../../../trafpy.manager.src.simulators.html#trafpy.manager.src.simulators.env_plotter.EnvsPlotter.plot_t_score_scatter">[docs]</a>    <span class="k">def</span> <span class="nf">plot_t_score_scatter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">analysers</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Plots performance indicators for T-scores.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;gridlines&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s1">&#39;aspect&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;font_size&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="k">if</span> <span class="s1">&#39;legend_ncol&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">nested_dict</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">nested_dict</span><span class="p">)</span>
        <span class="n">plot_dict</span> <span class="o">=</span> <span class="n">nested_dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">analyser</span> <span class="ow">in</span> <span class="n">analysers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_analyser_valid</span><span class="p">(</span><span class="n">analyser</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">][</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">analyser</span><span class="o">.</span><span class="n">throughput_component</span> 
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">][</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">analyser</span><span class="o">.</span><span class="n">fct_component</span> 


        <span class="n">figs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">load</span> <span class="ow">in</span> <span class="n">plot_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_scatter</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">load</span><span class="p">],</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Load </span><span class="si">{}</span><span class="s1"> Throughput Component&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">load</span><span class="p">,</span><span class="mi">2</span><span class="p">))),</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Load </span><span class="si">{}</span><span class="s1"> FCT Component&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">load</span><span class="p">,</span><span class="mi">2</span><span class="p">))),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">marker_size</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">logscale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span> <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;figsize&#39;</span><span class="p">],</span> <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">figs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">figs</span></div>

        

<div class="viewcode-block" id="EnvsPlotter.plot_mean_fct_vs_load"><a class="viewcode-back" href="../../../../../trafpy.manager.src.simulators.html#trafpy.manager.src.simulators.env_plotter.EnvsPlotter.plot_mean_fct_vs_load">[docs]</a>    <span class="k">def</span> <span class="nf">plot_mean_fct_vs_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">analysers</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        *analysers (*args): Analyser objects whose metrics you wish to plot.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;gridlines&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s1">&#39;aspect&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;cdf_figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cdf_figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;scatter_figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;font_size&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="k">if</span> <span class="s1">&#39;legend_ncol&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="s1">&#39;logscale&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_analyser_classes</span><span class="p">(</span><span class="o">*</span><span class="n">analysers</span><span class="p">)</span>
        <span class="n">plot_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">_class</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x_values&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;y_values&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;rand_vars&#39;</span><span class="p">:</span> <span class="p">[]}</span> <span class="k">for</span> <span class="n">_class</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">}</span>

        <span class="k">for</span> <span class="n">analyser</span> <span class="ow">in</span> <span class="n">analysers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_analyser_valid</span><span class="p">(</span><span class="n">analyser</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">mean_fct</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;rand_vars&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">mean_fct</span><span class="p">)</span>

        <span class="c1"># scatter</span>
        <span class="n">fig1</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_scatter</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                           <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Load&#39;</span><span class="p">,</span> 
                                           <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Mean FCT (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_units</span><span class="p">),</span> 
                                           <span class="n">plot_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                           <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span>
                                           <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span>
                                           <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">],</span>
                                           <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                           <span class="n">ylogscale</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">],</span>
                                           <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span>
                                           <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># complementary cdf</span>
        <span class="n">fig2</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_cdf</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                       <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Mean FCT (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_units</span><span class="p">),</span> 
                                       <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;C-CDF&#39;</span><span class="p">,</span> 
                                       <span class="n">complementary_cdf</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                       <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span>
                                       <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span>
                                       <span class="n">logscale</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">],</span>
                                       <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cdf_figsize&#39;</span><span class="p">],</span>
                                       <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                       <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span>
                                       <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># % change</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">plot_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">init_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">])</span>
            <span class="n">init_var</span> <span class="o">=</span> <span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">][</span><span class="n">init_idx</span><span class="p">]</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">init_var</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]))]</span>
        <span class="n">fig3</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_scatter</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                           <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Load&#39;</span><span class="p">,</span> 
                                           <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\u0394</span><span class="s1">F Mean FCT&#39;</span><span class="p">,</span> 
                                           <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                           <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                           <span class="n">plot_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                           <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">],</span> 
                                           <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                           <span class="n">ylogscale</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">],</span>
                                           <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                           <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig1</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/mean_fct_vs_load_scatter.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
            <span class="n">fig2</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/mean_fct_vs_load_complementary_cdf.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
            <span class="n">fig3</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/mean_fct_vs_load_change.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>


        <span class="k">return</span> <span class="p">[</span><span class="n">fig1</span><span class="p">,</span> <span class="n">fig2</span><span class="p">,</span> <span class="n">fig3</span><span class="p">]</span></div>

<div class="viewcode-block" id="EnvsPlotter.plot_99th_percentile_fct_vs_load"><a class="viewcode-back" href="../../../../../trafpy.manager.src.simulators.html#trafpy.manager.src.simulators.env_plotter.EnvsPlotter.plot_99th_percentile_fct_vs_load">[docs]</a>    <span class="k">def</span> <span class="nf">plot_99th_percentile_fct_vs_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">analysers</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;gridlines&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s1">&#39;aspect&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;cdf_figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cdf_figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;scatter_figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;font_size&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="k">if</span> <span class="s1">&#39;legend_ncol&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="s1">&#39;logscale&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_analyser_classes</span><span class="p">(</span><span class="o">*</span><span class="n">analysers</span><span class="p">)</span>
        <span class="n">plot_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">_class</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x_values&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;y_values&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;rand_vars&#39;</span><span class="p">:</span> <span class="p">[]}</span> <span class="k">for</span> <span class="n">_class</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">}</span>

        <span class="k">for</span> <span class="n">analyser</span> <span class="ow">in</span> <span class="n">analysers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_analyser_valid</span><span class="p">(</span><span class="n">analyser</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">nn_fct</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;rand_vars&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">nn_fct</span><span class="p">)</span>

        <span class="c1"># scatter</span>
        <span class="n">fig1</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_scatter</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                           <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Load&#39;</span><span class="p">,</span> 
                                           <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;p99 FCT (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_units</span><span class="p">),</span> 
                                           <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                           <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                           <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">],</span> 
                                           <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                           <span class="n">ylogscale</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">],</span>
                                           <span class="n">plot_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                           <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                           <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># complementary cdf</span>
        <span class="n">fig2</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_cdf</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                       <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;p99 FCT (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_units</span><span class="p">),</span> 
                                       <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;C-CDF&#39;</span><span class="p">,</span> 
                                       <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                       <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                       <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cdf_figsize&#39;</span><span class="p">],</span> 
                                       <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                       <span class="n">logscale</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">],</span>
                                       <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                       <span class="n">complementary_cdf</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                       <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># % change</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">plot_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">init_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">])</span>
            <span class="n">init_var</span> <span class="o">=</span> <span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">][</span><span class="n">init_idx</span><span class="p">]</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">init_var</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]))]</span>
        <span class="n">fig3</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_scatter</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                           <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Load&#39;</span><span class="p">,</span> 
                                           <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\u0394</span><span class="s1">F p99 FCT&#39;</span><span class="p">,</span> 
                                           <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                           <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                           <span class="n">plot_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                           <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">],</span> 
                                           <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                           <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                           <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig1</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/p99_fct_vs_load_scatter.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
            <span class="n">fig2</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/p99_fct_vs_load_complementary_cdf.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
            <span class="n">fig3</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/p99_fct_vs_load_change.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">fig1</span><span class="p">,</span> <span class="n">fig2</span><span class="p">,</span> <span class="n">fig3</span><span class="p">]</span></div>

<div class="viewcode-block" id="EnvsPlotter.plot_max_fct_vs_load"><a class="viewcode-back" href="../../../../../trafpy.manager.src.simulators.html#trafpy.manager.src.simulators.env_plotter.EnvsPlotter.plot_max_fct_vs_load">[docs]</a>    <span class="k">def</span> <span class="nf">plot_max_fct_vs_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">analysers</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;gridlines&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s1">&#39;aspect&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;cdf_figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cdf_figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;scatter_figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;font_size&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="k">if</span> <span class="s1">&#39;legend_ncol&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="s1">&#39;logscale&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_analyser_classes</span><span class="p">(</span><span class="o">*</span><span class="n">analysers</span><span class="p">)</span>
        <span class="n">plot_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">_class</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x_values&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;y_values&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;rand_vars&#39;</span><span class="p">:</span> <span class="p">[]}</span> <span class="k">for</span> <span class="n">_class</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">}</span>

        <span class="k">for</span> <span class="n">analyser</span> <span class="ow">in</span> <span class="n">analysers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_analyser_valid</span><span class="p">(</span><span class="n">analyser</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">max_fct</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;rand_vars&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">max_fct</span><span class="p">)</span>

        <span class="c1"># scatter</span>
        <span class="n">fig1</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_scatter</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                           <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Load&#39;</span><span class="p">,</span> 
                                           <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Max FCT (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_units</span><span class="p">),</span> 
                                           <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                           <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                           <span class="n">ylogscale</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">],</span>
                                           <span class="n">plot_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                           <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">],</span> 
                                           <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                           <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                           <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># complementary cdf</span>
        <span class="n">fig2</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_cdf</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                       <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Max FCT (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_units</span><span class="p">),</span> 
                                       <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;C-CDF&#39;</span><span class="p">,</span> 
                                       <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                       <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                       <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cdf_figsize&#39;</span><span class="p">],</span> 
                                       <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                       <span class="n">logscale</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">],</span>
                                       <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                       <span class="n">complementary_cdf</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                       <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># % change</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">plot_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">init_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">])</span>
            <span class="n">init_var</span> <span class="o">=</span> <span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">][</span><span class="n">init_idx</span><span class="p">]</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">init_var</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]))]</span>
        <span class="n">fig3</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_scatter</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                           <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Load&#39;</span><span class="p">,</span> 
                                           <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\u0394</span><span class="s1">F Max FCT&#39;</span><span class="p">,</span> 
                                           <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                           <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                           <span class="n">plot_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                           <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">],</span> 
                                           <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                           <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                           <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig1</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/max_fct_vs_load_scatter.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
            <span class="n">fig2</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/max_fct_vs_load_complementary_cdf.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
            <span class="n">fig3</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/max_fct_vs_load_change.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">fig1</span><span class="p">,</span> <span class="n">fig2</span><span class="p">]</span></div>

<div class="viewcode-block" id="EnvsPlotter.plot_fcts_cdf_for_different_loads"><a class="viewcode-back" href="../../../../../trafpy.manager.src.simulators.html#trafpy.manager.src.simulators.env_plotter.EnvsPlotter.plot_fcts_cdf_for_different_loads">[docs]</a>    <span class="k">def</span> <span class="nf">plot_fcts_cdf_for_different_loads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">analysers</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;gridlines&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s1">&#39;aspect&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;font_size&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="k">if</span> <span class="s1">&#39;legend_ncol&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># plot cdf of all fcts for each test subject for different loads</span>
        <span class="n">classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_analyser_classes</span><span class="p">(</span><span class="o">*</span><span class="n">analysers</span><span class="p">)</span>
        <span class="c1"># plot_dict = {_class: {&#39;x_values&#39;: [], &#39;rand_vars&#39;: []} for _class in classes}</span>

        <span class="n">nested_dict</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">nested_dict</span><span class="p">)</span>
        <span class="n">plot_dict</span> <span class="o">=</span> <span class="n">nested_dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">analyser</span> <span class="ow">in</span> <span class="n">analysers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_analyser_valid</span><span class="p">(</span><span class="n">analyser</span><span class="p">)</span>

            <span class="n">flow_completion_times</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">completed_flow_dicts</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="c1"># load from database</span>
                <span class="n">completed_flow_dicts</span> <span class="o">=</span> <span class="n">SqliteDict</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">completed_flow_dicts</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">completed_flow_dicts</span> <span class="o">=</span> <span class="n">analyser</span><span class="o">.</span><span class="n">completed_flow_dicts</span>
            <span class="k">for</span> <span class="n">flow</span> <span class="ow">in</span> <span class="n">completed_flow_dicts</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">flow_completion_times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">flow</span><span class="p">[</span><span class="s1">&#39;time_completed&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">flow</span><span class="p">[</span><span class="s1">&#39;time_arrived&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">completed_flow_dicts</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">completed_flow_dicts</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">][</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;rand_vars&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flow_completion_times</span>

        <span class="c1"># complementary cdf</span>
        <span class="n">figs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">load</span> <span class="ow">in</span> <span class="n">plot_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_cdf</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">load</span><span class="p">],</span> 
                                          <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Load </span><span class="si">{}</span><span class="s1"> FCTs (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">load</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_units</span><span class="p">),</span> 
                                          <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;C-CDF&#39;</span><span class="p">,</span> 
                                          <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                          <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                          <span class="n">logscale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                          <span class="n">plot_points</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                                          <span class="n">complementary_cdf</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                          <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;figsize&#39;</span><span class="p">],</span> 
                                          <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                          <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                          <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/fcts_cdf_load_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">load</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
            <span class="n">figs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">figs</span></div>



<div class="viewcode-block" id="EnvsPlotter.plot_fraction_of_arrived_flows_dropped_vs_load"><a class="viewcode-back" href="../../../../../trafpy.manager.src.simulators.html#trafpy.manager.src.simulators.env_plotter.EnvsPlotter.plot_fraction_of_arrived_flows_dropped_vs_load">[docs]</a>    <span class="k">def</span> <span class="nf">plot_fraction_of_arrived_flows_dropped_vs_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">analysers</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;cdf_figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cdf_figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;scatter_figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;font_size&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="k">if</span> <span class="s1">&#39;gridlines&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s1">&#39;aspect&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;legend_ncol&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="s1">&#39;logscale&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_analyser_classes</span><span class="p">(</span><span class="o">*</span><span class="n">analysers</span><span class="p">)</span>
        <span class="n">plot_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">_class</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x_values&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;y_values&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;rand_vars&#39;</span><span class="p">:</span> <span class="p">[]}</span> <span class="k">for</span> <span class="n">_class</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">}</span>

        <span class="k">for</span> <span class="n">analyser</span> <span class="ow">in</span> <span class="n">analysers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_analyser_valid</span><span class="p">(</span><span class="n">analyser</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">dropped_flow_frac</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;rand_vars&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">dropped_flow_frac</span><span class="p">)</span>

        <span class="c1"># scatter </span>
        <span class="n">fig1</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_scatter</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                           <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Load&#39;</span><span class="p">,</span> 
                                           <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Flows Dropped&#39;</span><span class="p">,</span> 
                                           <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                           <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                           <span class="n">plot_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                           <span class="n">ylogscale</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">],</span>
                                           <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">],</span> 
                                           <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                           <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                           <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># complementary cdf</span>
        <span class="n">fig2</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_cdf</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                       <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Flows Dropped&#39;</span><span class="p">,</span> 
                                       <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;C-CDF&#39;</span><span class="p">,</span> 
                                       <span class="n">complementary_cdf</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                       <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                       <span class="n">logscale</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">],</span>
                                       <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                       <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cdf_figsize&#39;</span><span class="p">],</span> 
                                       <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                       <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                       <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># % change</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">plot_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">init_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">])</span>
            <span class="n">init_var</span> <span class="o">=</span> <span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">][</span><span class="n">init_idx</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">init_var</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span> 
                <span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">init_var</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]))]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># was 0 flows dropped and now not -&gt; infinitely worse</span>
                <span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]))]</span>
        <span class="n">fig3</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_scatter</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                           <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Load&#39;</span><span class="p">,</span> 
                                           <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\u0394</span><span class="s1">F Flows Dropped&#39;</span><span class="p">,</span> 
                                           <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                           <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                           <span class="n">plot_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                           <span class="n">ylogscale</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">],</span>
                                           <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">],</span> 
                                           <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                           <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                           <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig1</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/frac_arrived_flows_dropped_vs_load_scatter.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
            <span class="n">fig2</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/frac_arrived_flows_dropped_vs_load_complementary_cdf.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
            <span class="n">fig3</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/frac_arrived_flows_dropped_vs_load_change.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">fig1</span><span class="p">,</span> <span class="n">fig2</span><span class="p">,</span> <span class="n">fig3</span><span class="p">]</span></div>

<div class="viewcode-block" id="EnvsPlotter.plot_fraction_of_arrived_info_dropped_vs_load"><a class="viewcode-back" href="../../../../../trafpy.manager.src.simulators.html#trafpy.manager.src.simulators.env_plotter.EnvsPlotter.plot_fraction_of_arrived_info_dropped_vs_load">[docs]</a>    <span class="k">def</span> <span class="nf">plot_fraction_of_arrived_info_dropped_vs_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">analysers</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;cdf_figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cdf_figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;scatter_figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;font_size&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="k">if</span> <span class="s1">&#39;gridlines&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s1">&#39;aspect&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;legend_ncol&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="s1">&#39;logscale&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_analyser_classes</span><span class="p">(</span><span class="o">*</span><span class="n">analysers</span><span class="p">)</span>
        <span class="n">plot_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">_class</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x_values&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;y_values&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;rand_vars&#39;</span><span class="p">:</span> <span class="p">[]}</span> <span class="k">for</span> <span class="n">_class</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">}</span>

        <span class="k">for</span> <span class="n">analyser</span> <span class="ow">in</span> <span class="n">analysers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_analyser_valid</span><span class="p">(</span><span class="n">analyser</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">dropped_info_frac</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;rand_vars&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">dropped_info_frac</span><span class="p">)</span>

        <span class="c1"># scatter </span>
        <span class="n">fig1</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_scatter</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                           <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Load&#39;</span><span class="p">,</span> 
                                           <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Info Dropped&#39;</span><span class="p">,</span> 
                                           <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                           <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                           <span class="n">plot_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                           <span class="n">ylogscale</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">],</span>
                                           <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">],</span> 
                                           <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                           <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                           <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># complementary cdf</span>
        <span class="n">fig2</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_cdf</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                       <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Info Dropped&#39;</span><span class="p">,</span> 
                                       <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;C-CDF&#39;</span><span class="p">,</span> 
                                       <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                       <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                       <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cdf_figsize&#39;</span><span class="p">],</span> 
                                       <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                       <span class="n">logscale</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">],</span>
                                       <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                       <span class="n">complementary_cdf</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                       <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># % change</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">plot_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">init_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">])</span>
            <span class="n">init_var</span> <span class="o">=</span> <span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">][</span><span class="n">init_idx</span><span class="p">]</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">init_var</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]))]</span>
        <span class="n">fig3</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_scatter</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                           <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Load&#39;</span><span class="p">,</span> 
                                           <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\u0394</span><span class="s1">F Info Dropped&#39;</span><span class="p">,</span> 
                                           <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                           <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                           <span class="n">ylogscale</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">],</span>
                                           <span class="n">plot_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                           <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">],</span> 
                                           <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                           <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                           <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig1</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/frac_arrived_info_dropped_vs_load_scatter.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
            <span class="n">fig2</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/frac_arrived_info_dropped_vs_load_complementary_cdf.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
            <span class="n">fig3</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/frac_arrived_info_dropped_vs_load_change.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">fig1</span><span class="p">,</span> <span class="n">fig2</span><span class="p">,</span> <span class="n">fig3</span><span class="p">]</span></div>


<div class="viewcode-block" id="EnvsPlotter.plot_src_dst_queue_evolution_for_different_loads"><a class="viewcode-back" href="../../../../../trafpy.manager.src.simulators.html#trafpy.manager.src.simulators.env_plotter.EnvsPlotter.plot_src_dst_queue_evolution_for_different_loads">[docs]</a>    <span class="k">def</span> <span class="nf">plot_src_dst_queue_evolution_for_different_loads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">length_type</span><span class="o">=</span><span class="s1">&#39;queue_lengths_num_flows&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">analysers</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">length_type</span> <span class="o">!=</span> <span class="s1">&#39;queue_lengths_num_flows&#39;</span> <span class="ow">and</span> <span class="n">length_type</span> <span class="o">!=</span> <span class="s1">&#39;queue_lengths_info_units&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;length_type must be either </span><span class="se">\&#39;</span><span class="s1">queue_lengths_num_flows</span><span class="se">\&#39;</span><span class="s1"> or </span><span class="se">\&#39;</span><span class="s1">queue_lengths_info_units</span><span class="se">\&#39;</span><span class="s1">, but is </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">length_type</span><span class="p">))</span>
        <span class="n">classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_analyser_classes</span><span class="p">(</span><span class="o">*</span><span class="n">analysers</span><span class="p">)</span>

        <span class="n">nested_dict</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">nested_dict</span><span class="p">)</span>
        <span class="n">plot_dict</span> <span class="o">=</span> <span class="n">nested_dict</span><span class="p">()</span>
        <span class="n">load_to_meas_time</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># collect measurement times for verical line plotting</span>
        <span class="k">for</span> <span class="n">analyser</span> <span class="ow">in</span> <span class="n">analysers</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">analyser</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">track_queue_evolution</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Must set track_queue_evolution=True when instantiating env simulation in order to plot queue evolution.&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_check_analyser_valid</span><span class="p">(</span><span class="n">analyser</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">][</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">analyser</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">queue_evolution_dict</span><span class="p">[</span><span class="n">src</span><span class="p">][</span><span class="n">dst</span><span class="p">][</span><span class="s1">&#39;times&#39;</span><span class="p">]</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">][</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">analyser</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">queue_evolution_dict</span><span class="p">[</span><span class="n">src</span><span class="p">][</span><span class="n">dst</span><span class="p">][</span><span class="n">length_type</span><span class="p">]</span>
            <span class="n">load_to_meas_time</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">measurement_start_time</span><span class="p">,</span> <span class="n">analyser</span><span class="o">.</span><span class="n">measurement_end_time</span><span class="p">]</span>

        <span class="c1"># set y-axis limits</span>
        <span class="k">if</span> <span class="n">length_type</span> <span class="o">==</span> <span class="s1">&#39;queue_lengths_num_flows&#39;</span><span class="p">:</span>
            <span class="n">load_to_ylim</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">analyser</span> <span class="ow">in</span> <span class="n">analysers</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">analyser</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">max_flows</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">load_to_ylim</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1.25</span><span class="o">*</span><span class="n">analyser</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">max_flows</span><span class="p">)]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># no max number of flows</span>
                    <span class="n">load_to_ylim</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">load_to_ylim</span> <span class="o">=</span> <span class="p">{</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">:</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">analyser</span> <span class="ow">in</span> <span class="n">analysers</span><span class="p">}</span>

        <span class="n">figs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">load</span> <span class="ow">in</span> <span class="n">plot_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">figs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_line</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">load</span><span class="p">],</span> 
                                                 <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> 
                                                 <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Load </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">-</span><span class="si">{}</span><span class="s1"> Queue Length&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">load</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">),</span> 
                                                 <span class="n">ylim</span><span class="o">=</span><span class="n">load_to_ylim</span><span class="p">[</span><span class="n">load</span><span class="p">],</span> 
                                                 <span class="n">vertical_lines</span><span class="o">=</span><span class="p">[</span><span class="n">load_to_meas_time</span><span class="p">[</span><span class="n">load</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> 
                                                 <span class="n">load_to_meas_time</span><span class="p">[</span><span class="n">load</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span> 
                                                 <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        
        <span class="k">return</span> <span class="n">figs</span></div>

<div class="viewcode-block" id="EnvsPlotter.plot_throughput_frac_vs_load"><a class="viewcode-back" href="../../../../../trafpy.manager.src.simulators.html#trafpy.manager.src.simulators.env_plotter.EnvsPlotter.plot_throughput_frac_vs_load">[docs]</a>    <span class="k">def</span> <span class="nf">plot_throughput_frac_vs_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">analysers</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;plot_bar_charts&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;plot_bar_charts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s1">&#39;gridlines&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s1">&#39;aspect&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;cdf_figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cdf_figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;scatter_figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;font_size&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="k">if</span> <span class="s1">&#39;legend_ncol&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_analyser_classes</span><span class="p">(</span><span class="o">*</span><span class="n">analysers</span><span class="p">)</span>

        <span class="c1"># init plot dict</span>
        <span class="n">nested_dict</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">nested_dict</span><span class="p">)</span>
        <span class="n">plot_dict</span> <span class="o">=</span> <span class="n">nested_dict</span><span class="p">()</span>
        <span class="n">plot_dict2</span> <span class="o">=</span> <span class="p">{</span><span class="n">_class</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x_values&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;y_values&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;rand_vars&#39;</span><span class="p">:</span> <span class="p">[]}</span> <span class="k">for</span> <span class="n">_class</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">}</span>
        <span class="n">load_to_meas_time</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># collect measurement times for verical line plotting</span>
        <span class="k">for</span> <span class="n">analyser</span> <span class="ow">in</span> <span class="n">analysers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_analyser_valid</span><span class="p">(</span><span class="n">analyser</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">analyser</span> <span class="ow">in</span> <span class="n">analysers</span><span class="p">:</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">throughput_frac</span><span class="p">)</span>

            <span class="n">plot_dict2</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">)</span>
            <span class="n">plot_dict2</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">throughput_frac</span><span class="p">)</span>
            <span class="n">plot_dict2</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;rand_vars&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">throughput_frac</span><span class="p">)</span>

        <span class="c1"># individual bar chars</span>
        <span class="n">figs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;plot_bar_charts&#39;</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">load</span> <span class="ow">in</span> <span class="n">plot_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">figs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_bar</span><span class="p">(</span><span class="n">x_values</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">load</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">],</span> <span class="n">y_values</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">load</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">],</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Test Subject Class&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Load </span><span class="si">{}</span><span class="s1"> Throughput (</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">load</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">info_units</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_units</span><span class="p">),</span> <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;figsize&#39;</span><span class="p">],</span> <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

        <span class="c1"># scatter</span>
        <span class="n">fig1</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_scatter</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict2</span><span class="p">,</span> 
                                           <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Load&#39;</span><span class="p">,</span> 
                                           <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Throughput&#39;</span><span class="p">,</span>
                                           <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                           <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                           <span class="n">plot_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                           <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">],</span> 
                                           <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                           <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                           <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># complementary cdf</span>
        <span class="n">fig2</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_cdf</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict2</span><span class="p">,</span> 
                                       <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Throughput&#39;</span><span class="p">,</span>
                                       <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;C-CDF&#39;</span><span class="p">,</span> 
                                       <span class="n">complementary_cdf</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                       <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                       <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                       <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cdf_figsize&#39;</span><span class="p">],</span> 
                                       <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                       <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                       <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig1</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/throughput_frac_vs_load_scatter.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
            <span class="n">fig2</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/throughput_frac_vs_load_complementary_cdf.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">figs</span><span class="p">,</span> <span class="n">fig1</span><span class="p">,</span> <span class="n">fig2</span><span class="p">]</span></div>


<div class="viewcode-block" id="EnvsPlotter.plot_throughput_rate_vs_load"><a class="viewcode-back" href="../../../../../trafpy.manager.src.simulators.html#trafpy.manager.src.simulators.env_plotter.EnvsPlotter.plot_throughput_rate_vs_load">[docs]</a>    <span class="k">def</span> <span class="nf">plot_throughput_rate_vs_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">analysers</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;plot_bar_charts&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;plot_bar_charts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s1">&#39;gridlines&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s1">&#39;aspect&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;cdf_figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cdf_figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;scatter_figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;font_size&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="k">if</span> <span class="s1">&#39;legend_ncol&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="s1">&#39;use_scientific_notation&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;use_scientific_notation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_analyser_classes</span><span class="p">(</span><span class="o">*</span><span class="n">analysers</span><span class="p">)</span>

        <span class="c1"># init plot dict</span>
        <span class="n">nested_dict</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">nested_dict</span><span class="p">)</span>
        <span class="n">plot_dict</span> <span class="o">=</span> <span class="n">nested_dict</span><span class="p">()</span>
        <span class="n">plot_dict2</span> <span class="o">=</span> <span class="p">{</span><span class="n">_class</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x_values&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;y_values&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;rand_vars&#39;</span><span class="p">:</span> <span class="p">[]}</span> <span class="k">for</span> <span class="n">_class</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">}</span>
        <span class="n">load_to_meas_time</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># collect measurement times for verical line plotting</span>
        <span class="k">for</span> <span class="n">analyser</span> <span class="ow">in</span> <span class="n">analysers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_analyser_valid</span><span class="p">(</span><span class="n">analyser</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>


        <span class="k">for</span> <span class="n">analyser</span> <span class="ow">in</span> <span class="n">analysers</span><span class="p">:</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">throughput_abs</span><span class="p">)</span>

            <span class="n">plot_dict2</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">)</span>
            <span class="n">plot_dict2</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">throughput_abs</span><span class="p">)</span>
            <span class="n">plot_dict2</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;rand_vars&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">throughput_abs</span><span class="p">)</span>

        <span class="c1"># individual bar chars</span>
        <span class="n">figs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;plot_bar_charts&#39;</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">load</span> <span class="ow">in</span> <span class="n">plot_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">figs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_bar</span><span class="p">(</span><span class="n">x_values</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">load</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">],</span> <span class="n">y_values</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">load</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">],</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Test Subject Class&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Load </span><span class="si">{}</span><span class="s1"> Throughput (</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">load</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">info_units</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_units</span><span class="p">),</span> <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;figsize&#39;</span><span class="p">],</span> <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

        <span class="c1"># scatter</span>
        <span class="n">fig1</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_scatter</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict2</span><span class="p">,</span> 
                                           <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Load&#39;</span><span class="p">,</span> 
                                           <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Throughput (</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">info_units</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_units</span><span class="p">),</span> 
                                           <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                           <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                           <span class="n">plot_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                           <span class="n">use_scientific_notation_yaxis</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;use_scientific_notation&#39;</span><span class="p">],</span>
                                           <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">],</span> 
                                           <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                           <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                           <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># complementary cdf</span>
        <span class="n">fig2</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_cdf</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict2</span><span class="p">,</span> 
                                       <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Throughput (</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">info_units</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_units</span><span class="p">),</span> 
                                       <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;C-CDF&#39;</span><span class="p">,</span> 
                                       <span class="n">complementary_cdf</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                       <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                       <span class="n">use_scientific_notation</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;use_scientific_notation&#39;</span><span class="p">],</span>
                                       <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                       <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cdf_figsize&#39;</span><span class="p">],</span> 
                                       <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                       <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                       <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        
        <span class="c1"># % change</span>
        <span class="n">plot_dict3</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">plot_dict2</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">plot_dict3</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">init_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">plot_dict3</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">])</span>
            <span class="n">init_var</span> <span class="o">=</span> <span class="n">plot_dict3</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">][</span><span class="n">init_idx</span><span class="p">]</span>
            <span class="n">plot_dict3</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">plot_dict3</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">init_var</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plot_dict3</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]))]</span>
        <span class="n">fig3</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_scatter</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict3</span><span class="p">,</span> 
                                           <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Load&#39;</span><span class="p">,</span> 
                                           <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\u0394</span><span class="s1">F Throughput&#39;</span><span class="p">,</span> 
                                           <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                           <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                           <span class="n">plot_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                           <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">],</span> 
                                           <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                           <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                           <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig1</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/throughput_rate_vs_load_scatter.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
            <span class="n">fig2</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/throughput_rate_vs_load_complementary_cdf.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
            <span class="n">fig3</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/throughput_rate_vs_load_change.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>



        <span class="k">return</span> <span class="p">[</span><span class="n">figs</span><span class="p">,</span> <span class="n">fig1</span><span class="p">,</span> <span class="n">fig2</span><span class="p">,</span> <span class="n">fig3</span><span class="p">]</span></div>


    <span class="c1"># def plot_radars_for_different_loads(self, *analysers, **kwargs):</span>
        <span class="c1"># if &#39;figsize&#39; not in kwargs:</span>
            <span class="c1"># kwargs[&#39;figsize&#39;] = (6.4, 4.8)</span>
        <span class="c1"># if &#39;n_ordinate_levels&#39; not in kwargs:</span>
            <span class="c1"># kwargs[&#39;n_ordinate_levels&#39;] = 5</span>
        <span class="c1"># if &#39;fill&#39; not in kwargs:</span>
            <span class="c1"># kwargs[&#39;fill&#39;] = True</span>
        <span class="c1"># if &#39;legend_ncol&#39; not in kwargs:</span>
            <span class="c1"># kwargs[&#39;legend_ncol&#39;] = 1</span>

        <span class="c1"># classes = self._group_analyser_classes(*analysers)</span>







<div class="viewcode-block" id="EnvsPlotter.plot_demand_slot_colour_grid_for_different_schedulers"><a class="viewcode-back" href="../../../../../trafpy.manager.src.simulators.html#trafpy.manager.src.simulators.env_plotter.EnvsPlotter.plot_demand_slot_colour_grid_for_different_schedulers">[docs]</a>    <span class="k">def</span> <span class="nf">plot_demand_slot_colour_grid_for_different_schedulers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">analysers</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;gridlines&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s1">&#39;aspect&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;font_size&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="k">if</span> <span class="s1">&#39;legend_ncol&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">figs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">analyser</span> <span class="ow">in</span> <span class="n">analysers</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">analyser</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">track_grid_slot_evolution</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Must set track_grid_slot_evolution=True when instantiating env simulation in order to plot grid.&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_analyser_valid</span><span class="p">(</span><span class="n">analyser</span><span class="p">)</span>
            <span class="n">figs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_demand_slot_colour_grid</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">grid_demands</span><span class="p">,</span> 
                                                                <span class="n">title</span><span class="o">=</span><span class="n">analyser</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">sim_name</span><span class="p">,</span> 
                                                                <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                                                                <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                                                <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                                                <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;figsize&#39;</span><span class="p">],</span> 
                                                                <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                                                <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">]))</span>

        <span class="k">return</span> <span class="n">figs</span></div>

<div class="viewcode-block" id="EnvsPlotter.find_index_of_int_in_str"><a class="viewcode-back" href="../../../../../trafpy.manager.src.simulators.html#trafpy.manager.src.simulators.env_plotter.EnvsPlotter.find_index_of_int_in_str">[docs]</a>    <span class="k">def</span> <span class="nf">find_index_of_int_in_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">string</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">int</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">idx</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="c1"># char is not an int</span>
                <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Could not find an integer in the string </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">string</span><span class="p">))</span></div>

<div class="viewcode-block" id="EnvsPlotter.plot_link_utilisation_vs_time_for_different_loads"><a class="viewcode-back" href="../../../../../trafpy.manager.src.simulators.html#trafpy.manager.src.simulators.env_plotter.EnvsPlotter.plot_link_utilisation_vs_time_for_different_loads">[docs]</a>    <span class="k">def</span> <span class="nf">plot_link_utilisation_vs_time_for_different_loads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">analysers</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;alpha&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="s1">&#39;plot_legend&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;plot_legend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s1">&#39;gridlines&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s1">&#39;aspect&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;font_size&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="k">if</span> <span class="s1">&#39;legend_ncol&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">nested_dict</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">nested_dict</span><span class="p">)</span>
        <span class="n">plot_dict</span> <span class="o">=</span> <span class="n">nested_dict</span><span class="p">()</span>

        <span class="n">link_types</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">analyser</span> <span class="ow">in</span> <span class="n">analysers</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">analyser</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">track_link_utilisation_evolution</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Must set track_link_utilisation_evolution=True when instantiating env simulation in order to plot link utilisation.&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_analyser_valid</span><span class="p">(</span><span class="n">analyser</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">link_utilisation_dict</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="c1"># link_utilisation_dict is in database</span>
                <span class="n">link_utilisation_dict</span> <span class="o">=</span> <span class="n">SqliteDict</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">link_utilisation_dict</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">link_utilisation_dict</span> <span class="o">=</span> <span class="n">analyser</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">link_utilisation_dict</span>

            <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">link_utilisation_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="c1"># assume node labels have format of edge type followed by underscore and int e.g. &#39;server_1&#39;, &#39;core_3&#39; etc</span>
                <span class="n">node1</span><span class="p">,</span> <span class="n">node2</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">link</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">link</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">idx1</span><span class="p">,</span> <span class="n">idx2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_index_of_int_in_str</span><span class="p">(</span><span class="n">node1</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_index_of_int_in_str</span><span class="p">(</span><span class="n">node2</span><span class="p">)</span>
                <span class="n">link_type</span> <span class="o">=</span> <span class="p">[</span><span class="n">node1</span><span class="p">[:</span><span class="n">idx1</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">node2</span><span class="p">[:</span><span class="n">idx2</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>

                <span class="c1"># OLD: Use to not consider different ports/directions on each link, but now should consider different directions separately...</span>
                <span class="n">flip_link</span><span class="o">=</span><span class="kc">False</span>
                <span class="k">if</span> <span class="n">link_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">link_types</span><span class="p">:</span>
                    <span class="n">flip_link</span><span class="o">=</span><span class="kc">True</span>
                    <span class="k">if</span> <span class="n">link_type</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">link_types</span><span class="p">:</span>
                        <span class="n">flip_link</span><span class="o">=</span><span class="kc">False</span>
                        <span class="n">link_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">link_type</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">flip_link</span><span class="p">:</span> 
                    <span class="n">link_type</span> <span class="o">=</span> <span class="n">link_type</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                <span class="n">time_slots</span> <span class="o">=</span> <span class="n">link_utilisation_dict</span><span class="p">[</span><span class="n">link</span><span class="p">][</span><span class="s1">&#39;time_slots&#39;</span><span class="p">]</span>
                <span class="n">util</span> <span class="o">=</span> <span class="n">link_utilisation_dict</span><span class="p">[</span><span class="n">link</span><span class="p">][</span><span class="s1">&#39;util&#39;</span><span class="p">]</span>


                <span class="c1"># average every n elements (time slots) in lists to smooth line plot</span>
                <span class="n">n</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mean_period&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="s1">&#39;mean_period&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">n</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mean_period&#39;</span><span class="p">]</span>
                    <span class="n">time_slots</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">([</span><span class="n">mean</span><span class="p">(</span><span class="n">time_slots</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">n</span><span class="p">])]</span><span class="o">*</span><span class="n">n</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">time_slots</span><span class="p">),</span><span class="n">n</span><span class="p">)))</span>
                    <span class="n">util</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">([</span><span class="n">mean</span><span class="p">(</span><span class="n">util</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">n</span><span class="p">])]</span><span class="o">*</span><span class="n">n</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">util</span><span class="p">),</span><span class="n">n</span><span class="p">)))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># not smoothing results by taking mean</span>
                    <span class="k">pass</span>

                <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">link_type</span><span class="p">)][</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">][</span><span class="n">link</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_slots</span>
                <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">link_type</span><span class="p">)][</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">][</span><span class="n">link</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">util</span>
                    

        <span class="n">load_to_meas_time</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># collect measurement times for verical line plotting</span>
        <span class="k">for</span> <span class="n">analyser</span> <span class="ow">in</span> <span class="n">analysers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_analyser_valid</span><span class="p">(</span><span class="n">analyser</span><span class="p">)</span>
            <span class="n">load_to_meas_time</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">measurement_start_time</span><span class="o">/</span><span class="n">analyser</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">slot_size</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">measurement_end_time</span><span class="o">/</span><span class="n">analyser</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">slot_size</span><span class="p">)]</span>


        <span class="n">figs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">subject_class</span> <span class="ow">in</span> <span class="n">plot_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">link_type</span> <span class="ow">in</span> <span class="n">plot_dict</span><span class="p">[</span><span class="n">subject_class</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="c1"># print(&#39;Plotting subject {} link type {}...&#39;.format(subject_class, link_type))</span>
                <span class="k">for</span> <span class="n">load</span> <span class="ow">in</span> <span class="n">plot_dict</span><span class="p">[</span><span class="n">subject_class</span><span class="p">][</span><span class="n">link_type</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_line</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">subject_class</span><span class="p">][</span><span class="n">link_type</span><span class="p">][</span><span class="n">load</span><span class="p">],</span> 
                                                   <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time Slot&#39;</span><span class="p">,</span> 
                                                   <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Load </span><span class="si">{}</span><span class="s1"> Link Util&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">subject_class</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">load</span><span class="p">,</span><span class="mi">2</span><span class="p">))),</span> 
                                                   <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> 
                                                   <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> 
                                                   <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">-</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">link_type</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">link_type</span><span class="p">)[</span><span class="mi">1</span><span class="p">]),</span>
                                                   <span class="n">alpha</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">],</span> 
                                                   <span class="n">vertical_lines</span><span class="o">=</span><span class="n">load_to_meas_time</span><span class="p">[</span><span class="n">load</span><span class="p">],</span> 
                                                   <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                                   <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                                   <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;figsize&#39;</span><span class="p">],</span> 
                                                   <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                                   <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                                   <span class="n">plot_legend</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;plot_legend&#39;</span><span class="p">],</span> 
                                                   <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">figs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">figs</span></div>


<div class="viewcode-block" id="EnvsPlotter.plot_link_concurrent_demands_vs_time_for_different_loads"><a class="viewcode-back" href="../../../../../trafpy.manager.src.simulators.html#trafpy.manager.src.simulators.env_plotter.EnvsPlotter.plot_link_concurrent_demands_vs_time_for_different_loads">[docs]</a>    <span class="k">def</span> <span class="nf">plot_link_concurrent_demands_vs_time_for_different_loads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">analysers</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;gridlines&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s1">&#39;aspect&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;font_size&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="k">if</span> <span class="s1">&#39;legend_ncol&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">nested_dict</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">nested_dict</span><span class="p">)</span>
        <span class="n">plot_dict</span> <span class="o">=</span> <span class="n">nested_dict</span><span class="p">()</span>

        <span class="n">link_types</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">analyser</span> <span class="ow">in</span> <span class="n">analysers</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">analyser</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">track_link_concurrent_demands_evolution</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Must set track_link_concurrent_demands_evolution=True when instantiating env simulation in order to plot number of concurrent demands.&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_analyser_valid</span><span class="p">(</span><span class="n">analyser</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">link_concurrent_demands_dict</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="c1"># link_utilisation_dict is in database</span>
                <span class="n">link_concurrent_demands_dict</span> <span class="o">=</span> <span class="n">SqliteDict</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">link_concurrent_demands_dict</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">link_concurrent_demands_dict</span> <span class="o">=</span> <span class="n">analyser</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">link_concurrent_demands_dict</span>
            <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">link_concurrent_demands_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="c1"># assume node labels have format of edge type followed by underscore and int e.g. &#39;server_1&#39;, &#39;core_3&#39; etc</span>
                <span class="n">node1</span><span class="p">,</span> <span class="n">node2</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">link</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">link</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">idx1</span><span class="p">,</span> <span class="n">idx2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_index_of_int_in_str</span><span class="p">(</span><span class="n">node1</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_index_of_int_in_str</span><span class="p">(</span><span class="n">node2</span><span class="p">)</span>
                <span class="n">link_type</span> <span class="o">=</span> <span class="p">[</span><span class="n">node1</span><span class="p">[:</span><span class="n">idx1</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">node2</span><span class="p">[:</span><span class="n">idx2</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
                <span class="n">flip_link</span><span class="o">=</span><span class="kc">False</span>
                <span class="k">if</span> <span class="n">link_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">link_types</span><span class="p">:</span>
                    <span class="n">flip_link</span><span class="o">=</span><span class="kc">True</span>
                    <span class="k">if</span> <span class="n">link_type</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">link_types</span><span class="p">:</span>
                        <span class="n">flip_link</span><span class="o">=</span><span class="kc">False</span>
                        <span class="n">link_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">link_type</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">flip_link</span><span class="p">:</span>
                    <span class="n">link_type</span> <span class="o">=</span> <span class="n">link_type</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                <span class="n">time_slots</span> <span class="o">=</span> <span class="n">link_concurrent_demands_dict</span><span class="p">[</span><span class="n">link</span><span class="p">][</span><span class="s1">&#39;time_slots&#39;</span><span class="p">]</span>
                <span class="n">concurrent_demands</span> <span class="o">=</span> <span class="n">link_concurrent_demands_dict</span><span class="p">[</span><span class="n">link</span><span class="p">][</span><span class="s1">&#39;concurrent_demands&#39;</span><span class="p">]</span>

                <span class="c1"># average every n elements (time slots) in lists</span>
                <span class="n">n</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mean_period&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="s1">&#39;mean_period&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">n</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mean_period&#39;</span><span class="p">]</span>
                    <span class="n">time_slots</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">([</span><span class="n">mean</span><span class="p">(</span><span class="n">time_slots</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">n</span><span class="p">])]</span><span class="o">*</span><span class="n">n</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">time_slots</span><span class="p">),</span><span class="n">n</span><span class="p">)))</span>
                    <span class="n">concurrent_demands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">([</span><span class="n">mean</span><span class="p">(</span><span class="n">concurrent_demands</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">n</span><span class="p">])]</span><span class="o">*</span><span class="n">n</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">concurrent_demands</span><span class="p">),</span><span class="n">n</span><span class="p">)))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># not smoothing results by taking mean</span>
                    <span class="k">pass</span>

                <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">link_type</span><span class="p">)][</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">][</span><span class="n">link</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_slots</span>
                <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">link_type</span><span class="p">)][</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">][</span><span class="n">link</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">concurrent_demands</span>

        <span class="n">load_to_meas_time</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># collect measurement times for verical line plotting</span>
        <span class="k">for</span> <span class="n">analyser</span> <span class="ow">in</span> <span class="n">analysers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_analyser_valid</span><span class="p">(</span><span class="n">analyser</span><span class="p">)</span>
            <span class="n">load_to_meas_time</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">measurement_start_time</span><span class="o">/</span><span class="n">analyser</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">slot_size</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">measurement_end_time</span><span class="o">/</span><span class="n">analyser</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">slot_size</span><span class="p">)]</span>


        <span class="n">figs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">subject_class</span> <span class="ow">in</span> <span class="n">plot_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">link_type</span> <span class="ow">in</span> <span class="n">plot_dict</span><span class="p">[</span><span class="n">subject_class</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">load</span> <span class="ow">in</span> <span class="n">plot_dict</span><span class="p">[</span><span class="n">subject_class</span><span class="p">][</span><span class="n">link_type</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_line</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">subject_class</span><span class="p">][</span><span class="n">link_type</span><span class="p">][</span><span class="n">load</span><span class="p">],</span> 
                                                   <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time Slot&#39;</span><span class="p">,</span> 
                                                   <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Load </span><span class="si">{}</span><span class="s1"> Concurrent Demands&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">subject_class</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">load</span><span class="p">,</span><span class="mi">2</span><span class="p">))),</span> 
                                                   <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="kc">None</span><span class="p">],</span> 
                                                   <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> 
                                                   <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                                                   <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">-</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">link_type</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">link_type</span><span class="p">)[</span><span class="mi">1</span><span class="p">]),</span>
                                                   <span class="n">vertical_lines</span><span class="o">=</span><span class="n">load_to_meas_time</span><span class="p">[</span><span class="n">load</span><span class="p">],</span> 
                                                   <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                                   <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                                   <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;figsize&#39;</span><span class="p">],</span> 
                                                   <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                                   <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                                   <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">figs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">figs</span></div>


<div class="viewcode-block" id="EnvsPlotter.plot_demand_completion_time_vs_size_for_different_loads"><a class="viewcode-back" href="../../../../../trafpy.manager.src.simulators.html#trafpy.manager.src.simulators.env_plotter.EnvsPlotter.plot_demand_completion_time_vs_size_for_different_loads">[docs]</a>    <span class="k">def</span> <span class="nf">plot_demand_completion_time_vs_size_for_different_loads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">analysers</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;alpha&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="s1">&#39;gridlines&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s1">&#39;aspect&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;font_size&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="k">if</span> <span class="s1">&#39;legend_ncol&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="s1">&#39;use_scientific_notation&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;use_scientific_notation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">nested_dict</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">nested_dict</span><span class="p">)</span>
        <span class="n">plot_dict</span> <span class="o">=</span> <span class="n">nested_dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">analyser</span> <span class="ow">in</span> <span class="n">analysers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_analyser_valid</span><span class="p">(</span><span class="n">analyser</span><span class="p">)</span>
            <span class="n">flow_completion_times</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">flow_sizes</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">completed_flow_dicts</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="c1"># load from database</span>
                <span class="n">completed_flow_dicts</span> <span class="o">=</span> <span class="n">SqliteDict</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">completed_flow_dicts</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">completed_flow_dicts</span> <span class="o">=</span> <span class="n">analyser</span><span class="o">.</span><span class="n">completed_flow_dicts</span>
            <span class="k">for</span> <span class="n">flow</span> <span class="ow">in</span> <span class="n">completed_flow_dicts</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">flow_completion_times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">flow</span><span class="p">[</span><span class="s1">&#39;time_completed&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">flow</span><span class="p">[</span><span class="s1">&#39;time_arrived&#39;</span><span class="p">])</span>
                <span class="n">flow_sizes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">flow</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">completed_flow_dicts</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">completed_flow_dicts</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">][</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flow_sizes</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">][</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flow_completion_times</span>

        <span class="n">load_to_meas_time</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># collect measurement times for verical line plotting</span>
        <span class="k">for</span> <span class="n">analyser</span> <span class="ow">in</span> <span class="n">analysers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_analyser_valid</span><span class="p">(</span><span class="n">analyser</span><span class="p">)</span>
            <span class="n">load_to_meas_time</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">measurement_start_time</span><span class="o">/</span><span class="n">analyser</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">slot_size</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">measurement_end_time</span><span class="o">/</span><span class="n">analyser</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">slot_size</span><span class="p">)]</span>

        <span class="n">figs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">load</span> <span class="ow">in</span> <span class="n">plot_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_scatter</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">load</span><span class="p">],</span> 
                                              <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Flow Size (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">info_units</span><span class="p">),</span> 
                                              <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Load </span><span class="si">{}</span><span class="s1"> FCT (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">load</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_units</span><span class="p">),</span> 
                                              <span class="n">alpha</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">],</span> 
                                              <span class="n">logscale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                              <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                              <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                              <span class="n">use_scientific_notation_yaxis</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;use_scientific_notation_yaxis&#39;</span><span class="p">],</span>
                                              <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;figsize&#39;</span><span class="p">],</span> 
                                              <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                              <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                              <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/demand_completion_time_vs_size_load_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">load</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
            <span class="n">figs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">figs</span></div>








    <span class="c1"># ############################### BASRPT #################################</span>

    <span class="c1"># def plot_mean_fct_vs_basrpt_v(self, *analysers):</span>
        <span class="c1"># classes = self._group_analyser_classes(*analysers)</span>
        <span class="c1"># plot_dict = {_class: {&#39;x_values&#39;: [], &#39;y_values&#39;: [], &#39;rand_vars&#39;: []} for _class in classes}</span>

        <span class="c1"># for analyser in analysers:</span>
            <span class="c1"># self._check_analyser_valid(analyser)</span>
            <span class="c1"># plot_dict[analyser.subject_class_name][&#39;x_values&#39;].append(analyser.env.scheduler.V)</span>
            <span class="c1"># plot_dict[analyser.subject_class_name][&#39;y_values&#39;].append(analyser.mean_fct)</span>
            <span class="c1"># plot_dict[analyser.subject_class_name][&#39;rand_vars&#39;].append(analyser.mean_fct)</span>

        <span class="c1"># # scatter</span>
        <span class="c1"># fig1 = plot_dists.plot_val_scatter(plot_dict=plot_dict, xlabel=&#39;V&#39;, ylabel=&#39;Average FCT&#39;, show_fig=True)</span>

        <span class="c1"># # complementary cdf</span>
        <span class="c1"># fig2 = plot_dists.plot_val_cdf(plot_dict=plot_dict, xlabel=&#39;Average FCT&#39;, ylabel=&#39;C-CDF&#39;, complementary_cdf=True, show_fig=True)</span>

        <span class="c1"># return [fig1, fig2]</span>
    
    <span class="c1"># def plot_99th_percentile_fct_vs_basrpt_v(self, *analysers):</span>
        <span class="c1"># classes = self._group_analyser_classes(*analysers)</span>
        <span class="c1"># plot_dict = {_class: {&#39;x_values&#39;: [], &#39;y_values&#39;: [], &#39;rand_vars&#39;: []} for _class in classes}</span>

        <span class="c1"># for analyser in analysers:</span>
            <span class="c1"># self._check_analyser_valid(analyser)</span>
            <span class="c1"># plot_dict[analyser.subject_class_name][&#39;x_values&#39;].append(analyser.env.scheduler.V)</span>
            <span class="c1"># plot_dict[analyser.subject_class_name][&#39;y_values&#39;].append(analyser.nn_fct)</span>
            <span class="c1"># plot_dict[analyser.subject_class_name][&#39;rand_vars&#39;].append(analyser.nn_fct)</span>

        <span class="c1"># # scatter</span>
        <span class="c1"># fig1 = plot_dists.plot_val_scatter(plot_dict=plot_dict, xlabel=&#39;V&#39;, ylabel=&#39;99th Percentile FCT&#39;, show_fig=True)</span>

        <span class="c1"># # complementary cdf</span>
        <span class="c1"># fig2 = plot_dists.plot_val_cdf(plot_dict=plot_dict, xlabel=&#39;99th Percentile FCT&#39;, ylabel=&#39;C-CDF&#39;, complementary_cdf=True, show_fig=True)</span>

        <span class="c1"># return [fig1, fig2]</span>


    <span class="c1"># def plot_throughput_vs_basrpt_v(self, analysers):</span>
        <span class="c1"># classes = self._group_analyser_classes(*analysers)</span>
        <span class="c1"># plot_dict = {_class: {&#39;x_values&#39;: [], &#39;y_values&#39;: [], &#39;rand_vars&#39;: []} for _class in classes}</span>

        <span class="c1"># for analyser in analysers:</span>
            <span class="c1"># self._check_analyser_valid(analyser)</span>
            <span class="c1"># plot_dict[analyser.subject_class_name][&#39;x_values&#39;].append(analyser.env.scheduler.V)</span>
            <span class="c1"># plot_dict[analyser.subject_class_name][&#39;y_values&#39;].append(analyser.throughput_abs)</span>
            <span class="c1"># plot_dict[analyser.subject_class_name][&#39;rand_vars&#39;].append(analyser.throughput_abs)</span>

        <span class="c1"># # scatter</span>
        <span class="c1"># fig1 = plot_dists.plot_val_scatter(plot_dict=plot_dict, xlabel=&#39;V&#39;, ylabel=&#39;Throughput&#39;, show_fig=True)</span>

        <span class="c1"># # complementary cdf</span>
        <span class="c1"># fig2 = plot_dists.plot_val_cdf(plot_dict=plot_dict, xlabel=&#39;Throughput&#39;, ylabel=&#39;C-CDF&#39;, complementary_cdf=True, show_fig=True)</span>

        <span class="c1"># return [fig1, fig2]</span>


<div class="viewcode-block" id="EnvsPlotter.plot_jcts_cdf_for_different_loads"><a class="viewcode-back" href="../../../../../trafpy.manager.src.simulators.html#trafpy.manager.src.simulators.env_plotter.EnvsPlotter.plot_jcts_cdf_for_different_loads">[docs]</a>    <span class="k">def</span> <span class="nf">plot_jcts_cdf_for_different_loads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">analysers</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;gridlines&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s1">&#39;aspect&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;font_size&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="k">if</span> <span class="s1">&#39;legend_ncol&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># plot cdf of all jcts for each test subject for different loads</span>
        <span class="n">classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_analyser_classes</span><span class="p">(</span><span class="o">*</span><span class="n">analysers</span><span class="p">)</span>
        <span class="c1"># plot_dict = {_class: {&#39;x_values&#39;: [], &#39;rand_vars&#39;: []} for _class in classes}</span>

        <span class="n">nested_dict</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">nested_dict</span><span class="p">)</span>
        <span class="n">plot_dict</span> <span class="o">=</span> <span class="n">nested_dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">analyser</span> <span class="ow">in</span> <span class="n">analysers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_analyser_valid</span><span class="p">(</span><span class="n">analyser</span><span class="p">)</span>

            <span class="n">job_completion_times</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">completed_job_dicts</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="c1"># load from database</span>
                <span class="n">completed_job_dicts</span> <span class="o">=</span> <span class="n">SqliteDict</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">completed_job_dicts</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">completed_job_dicts</span> <span class="o">=</span> <span class="n">analyser</span><span class="o">.</span><span class="n">completed_job_dicts</span>
            <span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="n">completed_job_dicts</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">job_completion_times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">job</span><span class="p">[</span><span class="s1">&#39;time_completed&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">job</span><span class="p">[</span><span class="s1">&#39;time_arrived&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">completed_job_dicts</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">completed_job_dicts</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">][</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;rand_vars&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">job_completion_times</span>

        <span class="c1"># complementary cdf</span>
        <span class="n">figs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">load</span> <span class="ow">in</span> <span class="n">plot_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_cdf</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">load</span><span class="p">],</span> 
                                          <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Load </span><span class="si">{}</span><span class="s1"> JCTs (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">load</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_units</span><span class="p">),</span> 
                                          <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;C-CDF&#39;</span><span class="p">,</span> 
                                          <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                          <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                          <span class="n">logscale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                          <span class="n">plot_points</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                                          <span class="n">complementary_cdf</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                          <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;figsize&#39;</span><span class="p">],</span> 
                                          <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                          <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                          <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/jcts_cdf_load_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">load</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
            <span class="n">figs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">figs</span></div>


<div class="viewcode-block" id="EnvsPlotter.plot_mean_jct_vs_load"><a class="viewcode-back" href="../../../../../trafpy.manager.src.simulators.html#trafpy.manager.src.simulators.env_plotter.EnvsPlotter.plot_mean_jct_vs_load">[docs]</a>    <span class="k">def</span> <span class="nf">plot_mean_jct_vs_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">analysers</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        *analysers (*args): Analyser objects whose metrics you wish to plot.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;gridlines&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s1">&#39;aspect&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;cdf_figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cdf_figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;scatter_figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;font_size&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="k">if</span> <span class="s1">&#39;legend_ncol&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="s1">&#39;logscale&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_analyser_classes</span><span class="p">(</span><span class="o">*</span><span class="n">analysers</span><span class="p">)</span>
        <span class="n">plot_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">_class</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x_values&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;y_values&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;rand_vars&#39;</span><span class="p">:</span> <span class="p">[]}</span> <span class="k">for</span> <span class="n">_class</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">}</span>

        <span class="k">for</span> <span class="n">analyser</span> <span class="ow">in</span> <span class="n">analysers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_analyser_valid</span><span class="p">(</span><span class="n">analyser</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">mean_jct</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;rand_vars&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">mean_jct</span><span class="p">)</span>

        <span class="c1"># scatter</span>
        <span class="n">fig1</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_scatter</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                           <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Load&#39;</span><span class="p">,</span> 
                                           <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Mean JCT (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_units</span><span class="p">),</span> 
                                           <span class="n">plot_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                           <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span>
                                           <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span>
                                           <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">],</span>
                                           <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                           <span class="n">ylogscale</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">],</span>
                                           <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span>
                                           <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># complementary cdf</span>
        <span class="n">fig2</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_cdf</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                       <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Mean JCT (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_units</span><span class="p">),</span> 
                                       <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;C-CDF&#39;</span><span class="p">,</span> 
                                       <span class="n">complementary_cdf</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                       <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span>
                                       <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span>
                                       <span class="n">logscale</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">],</span>
                                       <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cdf_figsize&#39;</span><span class="p">],</span>
                                       <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                       <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span>
                                       <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># % change</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">plot_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">init_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">])</span>
            <span class="n">init_var</span> <span class="o">=</span> <span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">][</span><span class="n">init_idx</span><span class="p">]</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">init_var</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]))]</span>
        <span class="n">fig3</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_scatter</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                           <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Load&#39;</span><span class="p">,</span> 
                                           <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\u0394</span><span class="s1">F Mean JCT&#39;</span><span class="p">,</span> 
                                           <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                           <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                           <span class="n">plot_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                           <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">],</span> 
                                           <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                           <span class="n">ylogscale</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">],</span>
                                           <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                           <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig1</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/mean_jct_vs_load_scatter.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
            <span class="n">fig2</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/mean_jct_vs_load_complementary_cdf.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
            <span class="n">fig3</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/mean_jct_vs_load_change.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">fig1</span><span class="p">,</span> <span class="n">fig2</span><span class="p">,</span> <span class="n">fig3</span><span class="p">]</span></div>



<div class="viewcode-block" id="EnvsPlotter.plot_99th_percentile_jct_vs_load"><a class="viewcode-back" href="../../../../../trafpy.manager.src.simulators.html#trafpy.manager.src.simulators.env_plotter.EnvsPlotter.plot_99th_percentile_jct_vs_load">[docs]</a>    <span class="k">def</span> <span class="nf">plot_99th_percentile_jct_vs_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">analysers</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;gridlines&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s1">&#39;aspect&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;cdf_figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cdf_figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;scatter_figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;font_size&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="k">if</span> <span class="s1">&#39;legend_ncol&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="s1">&#39;logscale&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_analyser_classes</span><span class="p">(</span><span class="o">*</span><span class="n">analysers</span><span class="p">)</span>
        <span class="n">plot_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">_class</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x_values&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;y_values&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;rand_vars&#39;</span><span class="p">:</span> <span class="p">[]}</span> <span class="k">for</span> <span class="n">_class</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">}</span>

        <span class="k">for</span> <span class="n">analyser</span> <span class="ow">in</span> <span class="n">analysers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_analyser_valid</span><span class="p">(</span><span class="n">analyser</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">nn_jct</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;rand_vars&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">nn_jct</span><span class="p">)</span>

        <span class="c1"># scatter</span>
        <span class="n">fig1</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_scatter</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                           <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Load&#39;</span><span class="p">,</span> 
                                           <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;p99 JCT (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_units</span><span class="p">),</span> 
                                           <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                           <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                           <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">],</span> 
                                           <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                           <span class="n">ylogscale</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">],</span>
                                           <span class="n">plot_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                           <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                           <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># complementary cdf</span>
        <span class="n">fig2</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_cdf</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                       <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;p99 JCT (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_units</span><span class="p">),</span> 
                                       <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;C-CDF&#39;</span><span class="p">,</span> 
                                       <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                       <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                       <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cdf_figsize&#39;</span><span class="p">],</span> 
                                       <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                       <span class="n">logscale</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">],</span>
                                       <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                       <span class="n">complementary_cdf</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                       <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># % change</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">plot_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">init_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">])</span>
            <span class="n">init_var</span> <span class="o">=</span> <span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">][</span><span class="n">init_idx</span><span class="p">]</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">init_var</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]))]</span>
        <span class="n">fig3</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_scatter</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                           <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Load&#39;</span><span class="p">,</span> 
                                           <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\u0394</span><span class="s1">F p99 JCT&#39;</span><span class="p">,</span> 
                                           <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                           <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                           <span class="n">plot_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                           <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">],</span> 
                                           <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                           <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                           <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig1</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/p99_jct_vs_load_scatter.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
            <span class="n">fig2</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/p99_jct_vs_load_complementary_cdf.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
            <span class="n">fig3</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/p99_jct_vs_load_change.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">fig1</span><span class="p">,</span> <span class="n">fig2</span><span class="p">,</span> <span class="n">fig3</span><span class="p">]</span></div>


<div class="viewcode-block" id="EnvsPlotter.plot_max_jct_vs_load"><a class="viewcode-back" href="../../../../../trafpy.manager.src.simulators.html#trafpy.manager.src.simulators.env_plotter.EnvsPlotter.plot_max_jct_vs_load">[docs]</a>    <span class="k">def</span> <span class="nf">plot_max_jct_vs_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">analysers</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;gridlines&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s1">&#39;aspect&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;cdf_figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cdf_figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;scatter_figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;font_size&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="k">if</span> <span class="s1">&#39;legend_ncol&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="s1">&#39;logscale&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_analyser_classes</span><span class="p">(</span><span class="o">*</span><span class="n">analysers</span><span class="p">)</span>
        <span class="n">plot_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">_class</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x_values&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;y_values&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;rand_vars&#39;</span><span class="p">:</span> <span class="p">[]}</span> <span class="k">for</span> <span class="n">_class</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">}</span>

        <span class="k">for</span> <span class="n">analyser</span> <span class="ow">in</span> <span class="n">analysers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_analyser_valid</span><span class="p">(</span><span class="n">analyser</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">max_jct</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;rand_vars&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">max_jct</span><span class="p">)</span>

        <span class="c1"># scatter</span>
        <span class="n">fig1</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_scatter</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                           <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Load&#39;</span><span class="p">,</span> 
                                           <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Max JCT (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_units</span><span class="p">),</span> 
                                           <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                           <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                           <span class="n">ylogscale</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">],</span>
                                           <span class="n">plot_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                           <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">],</span> 
                                           <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                           <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                           <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># complementary cdf</span>
        <span class="n">fig2</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_cdf</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                       <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Max JCT (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_units</span><span class="p">),</span> 
                                       <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;C-CDF&#39;</span><span class="p">,</span> 
                                       <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                       <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                       <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cdf_figsize&#39;</span><span class="p">],</span> 
                                       <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                       <span class="n">logscale</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">],</span>
                                       <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                       <span class="n">complementary_cdf</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                       <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># % change</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">plot_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">init_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">])</span>
            <span class="n">init_var</span> <span class="o">=</span> <span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">][</span><span class="n">init_idx</span><span class="p">]</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">init_var</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]))]</span>
        <span class="n">fig3</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_scatter</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                           <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Load&#39;</span><span class="p">,</span> 
                                           <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\u0394</span><span class="s1">F Max JCT&#39;</span><span class="p">,</span> 
                                           <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                           <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                           <span class="n">plot_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                           <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">],</span> 
                                           <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                           <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                           <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig1</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/max_jct_vs_load_scatter.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
            <span class="n">fig2</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/max_jct_vs_load_complementary_cdf.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
            <span class="n">fig3</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/max_jct_vs_load_change.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">fig1</span><span class="p">,</span> <span class="n">fig2</span><span class="p">]</span></div>


<div class="viewcode-block" id="EnvsPlotter.plot_fraction_of_arrived_jobs_dropped_vs_load"><a class="viewcode-back" href="../../../../../trafpy.manager.src.simulators.html#trafpy.manager.src.simulators.env_plotter.EnvsPlotter.plot_fraction_of_arrived_jobs_dropped_vs_load">[docs]</a>    <span class="k">def</span> <span class="nf">plot_fraction_of_arrived_jobs_dropped_vs_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">analysers</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;cdf_figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cdf_figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;scatter_figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;font_size&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="k">if</span> <span class="s1">&#39;gridlines&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s1">&#39;aspect&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;legend_ncol&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="s1">&#39;logscale&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group_analyser_classes</span><span class="p">(</span><span class="o">*</span><span class="n">analysers</span><span class="p">)</span>
        <span class="n">plot_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">_class</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x_values&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;y_values&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;rand_vars&#39;</span><span class="p">:</span> <span class="p">[]}</span> <span class="k">for</span> <span class="n">_class</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">}</span>

        <span class="k">for</span> <span class="n">analyser</span> <span class="ow">in</span> <span class="n">analysers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_analyser_valid</span><span class="p">(</span><span class="n">analyser</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">load_frac</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">dropped_job_frac</span><span class="p">)</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">analyser</span><span class="o">.</span><span class="n">subject_class_name</span><span class="p">][</span><span class="s1">&#39;rand_vars&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analyser</span><span class="o">.</span><span class="n">dropped_job_frac</span><span class="p">)</span>

        <span class="c1"># scatter </span>
        <span class="n">fig1</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_scatter</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                           <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Load&#39;</span><span class="p">,</span> 
                                           <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Jobs Dropped&#39;</span><span class="p">,</span> 
                                           <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                           <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                           <span class="n">plot_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                           <span class="n">ylogscale</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">],</span>
                                           <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">],</span> 
                                           <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                           <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                           <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># complementary cdf</span>
        <span class="n">fig2</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_cdf</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                       <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Jobs Dropped&#39;</span><span class="p">,</span> 
                                       <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;C-CDF&#39;</span><span class="p">,</span> 
                                       <span class="n">complementary_cdf</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                       <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                       <span class="n">logscale</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">],</span>
                                       <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                       <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cdf_figsize&#39;</span><span class="p">],</span> 
                                       <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                       <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                       <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># % change</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">plot_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">init_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">])</span>
            <span class="n">init_var</span> <span class="o">=</span> <span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">][</span><span class="n">init_idx</span><span class="p">]</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">init_var</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]))]</span>
        <span class="n">fig3</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_scatter</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                           <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Load&#39;</span><span class="p">,</span> 
                                           <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\u0394</span><span class="s1">F Jobs Dropped&#39;</span><span class="p">,</span> 
                                           <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                           <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                           <span class="n">plot_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                           <span class="n">ylogscale</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">],</span>
                                           <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">],</span> 
                                           <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                           <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                           <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig1</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/frac_arrived_jobs_dropped_vs_load_scatter.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
            <span class="n">fig2</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/frac_arrived_jobs_dropped_vs_load_complementary_cdf.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
            <span class="n">fig3</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/frac_arrived_jobs_dropped_vs_load_change.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">fig1</span><span class="p">,</span> <span class="n">fig2</span><span class="p">,</span> <span class="n">fig3</span><span class="p">]</span></div></div>





























<span class="c1"># FUNCS</span>
<div class="viewcode-block" id="plot_summary_dict_params"><a class="viewcode-back" href="../../../../../trafpy.manager.src.simulators.html#trafpy.manager.src.simulators.env_plotter.plot_summary_dict_params">[docs]</a><span class="k">def</span> <span class="nf">plot_summary_dict_params</span><span class="p">(</span><span class="n">summary_dicts</span><span class="p">,</span> 
                             <span class="n">error_summary_dicts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">dependent_var_name</span><span class="o">=</span><span class="s1">&#39;Random Variable&#39;</span><span class="p">,</span> 
                              <span class="n">dependent_var_display_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">control_var_name</span><span class="o">=</span><span class="s1">&#39;Param&#39;</span><span class="p">,</span> 
                              <span class="n">loads</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span> 
                              <span class="n">subjects_to_plot</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
                              <span class="n">path_to_save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This function is for when you have used `envs_plotter&#39; to plot individual</span>
<span class="sd">    simulation statistics for various loads, and now wish to do some plots</span>
<span class="sd">    across multiple simulation statistics for cross-simulation analysis. Note</span>
<span class="sd">    that this notebook requires you having set a path_to_save string when</span>
<span class="sd">    calling `envs_plotter&#39; so that an `envs_plotter&#39;_ directory contains a</span>
<span class="sd">    summary_dataframe.pkl file.</span>

<span class="sd">    summary_dicts should be a dict of dicts. The keys of summary_dicts should</span>
<span class="sd">    be the parameter values of the control_var_name (e.g. for</span>
<span class="sd">    rack_dist_sensitivity benchmark, would be 0.2, 0.4, 0.6, and 0.8 for 20%,</span>
<span class="sd">    40%, 60%, and 80% intra-rack traffic).  The values are the originial</span>
<span class="sd">    summary_dataframe.pkl file which has been loaded as a pandas dataframe and</span>
<span class="sd">    converted to a dict (pf.read_pickle(path_to_summary_dataframe.pkl).to_dict)</span>

<span class="sd">    The keys of these individual summary dicts will be e.g. &#39;Load&#39;, &#39;Subject&#39;,</span>
<span class="sd">    &#39;Mean FCT&#39; etc., and the values will be the corresponding values.</span>

<span class="sd">    If error_summary_dicts is not None, should be a summary_dict formatted in same</span>
<span class="sd">    way as summary_dicts but containing the error (e.g. std) for each stat.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">dependent_var_display_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dependent_var_display_name</span> <span class="o">=</span> <span class="n">dependent_var_name</span>
    <span class="k">if</span> <span class="s1">&#39;gridlines&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="s1">&#39;aspect&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;cdf_figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cdf_figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;scatter_figsize&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;font_size&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="k">if</span> <span class="s1">&#39;legend_ncol&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="s1">&#39;logscale&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="s1">&#39;use_scientific_notation&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;use_scientific_notation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="s1">&#39;replace_summary_dict_dependent_var_name&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span> <span class="c1"># useful to replace to e.g. replace Throughput Frac with Throughput, but less useful if want to keep e.g. Mean FCT units</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;replace_summary_dict_dependent_var_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="n">all_subjects</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">summary_dicts</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">summary_dicts</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;Subject&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
    <span class="n">ghost_subjects</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># track which (if any) subjects not plotted so retain consistent plot class colours</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">subjects_to_plot</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">subjects_to_plot</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="n">subjects_to_plot</span> <span class="o">=</span> <span class="n">all_subjects</span>
             <span class="c1"># no ghost subjects needed to keep same class plot colours</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># check if any subjects not included, add to ghost_subjects if not included</span>
        <span class="k">for</span> <span class="n">subject</span> <span class="ow">in</span> <span class="n">all_subjects</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">subject</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">subjects_to_plot</span><span class="p">:</span>
                <span class="n">ghost_subjects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">control_var_name</span> <span class="o">!=</span> <span class="s1">&#39;Load&#39;</span><span class="p">:</span>
        <span class="c1"># check loads are in summary_dicts, since somtimes get e.g. 0.89 instead of 0.9</span>
        <span class="n">_loads</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">summ_loads</span> <span class="o">=</span>  <span class="nb">list</span><span class="p">(</span><span class="n">summary_dicts</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">summary_dicts</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;Load&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">load</span> <span class="ow">in</span> <span class="n">loads</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">load</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">summ_loads</span><span class="p">:</span>
                <span class="c1"># load not in summary_dicts</span>
                <span class="c1"># see if +- 0.01 helps</span>
                <span class="n">load_plus</span><span class="p">,</span> <span class="n">load_minus</span> <span class="o">=</span> <span class="n">load</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">load</span> <span class="o">-</span> <span class="mf">0.01</span>
                <span class="k">if</span> <span class="n">load_plus</span> <span class="ow">in</span> <span class="n">summ_loads</span><span class="p">:</span>
                    <span class="n">_loads</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">load_plus</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">load_minus</span> <span class="ow">in</span> <span class="n">summ_loads</span><span class="p">:</span>
                    <span class="n">_loads</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">load_minus</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Unable to find load </span><span class="si">{}</span><span class="s1"> in summary dict loads </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">load</span><span class="p">,</span> <span class="n">summ_loads</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># load in summary_dicts</span>
                <span class="n">_loads</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">load</span><span class="p">)</span>
        <span class="c1"># update list of loads to ensure compatible with summary_dicts</span>
        <span class="n">loads</span> <span class="o">=</span> <span class="n">_loads</span>


    
    <span class="k">if</span> <span class="n">control_var_name</span> <span class="o">!=</span> <span class="s1">&#39;Load&#39;</span><span class="p">:</span>
        <span class="c1"># plot separate plot for each load</span>
        <span class="n">num_plots</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">loads</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># only plot one plot for all loads</span>
        <span class="n">num_plots</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">counter</span> <span class="o">!=</span> <span class="n">num_plots</span><span class="p">:</span>
        <span class="c1"># new plot</span>

        <span class="k">if</span> <span class="n">control_var_name</span> <span class="o">!=</span> <span class="s1">&#39;Load&#39;</span><span class="p">:</span>
            <span class="c1"># separate plots for each load. Get load</span>
            <span class="n">load</span> <span class="o">=</span> <span class="n">loads</span><span class="p">[</span><span class="n">counter</span><span class="p">]</span>

        <span class="c1"># get rand var key</span>
        <span class="n">rand_var_key</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">summary_dicts</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">summary_dicts</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">dependent_var_name</span> <span class="o">!=</span> <span class="s1">&#39;Throughput&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">dependent_var_name</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                    <span class="n">rand_var_key</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                    <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># have Throughput and Throughput (xxx), so need to distinguish</span>
                <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="n">dependent_var_name</span><span class="p">:</span>
                    <span class="n">rand_var_key</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                    <span class="k">break</span>
        <span class="k">if</span> <span class="n">rand_var_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Unable to find </span><span class="si">{}</span><span class="s1"> in </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dependent_var_name</span><span class="p">,</span> <span class="n">summary_dicts</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">summary_dicts</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>

        <span class="c1"># get subjects, rand vars and (optional) error (e.g. std) for each var </span>
        <span class="n">subjects</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">rand_vars</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">control_var_name</span> <span class="o">!=</span> <span class="s1">&#39;Load&#39;</span><span class="p">:</span>
            <span class="c1"># must append control var param values to list</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">params_iterator</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">summary_dicts</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># control var param values are just the loads</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="n">load</span> <span class="k">for</span> <span class="n">load</span> <span class="ow">in</span> <span class="n">summary_dicts</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;Load&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="nb">round</span><span class="p">(</span><span class="n">load</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">in</span> <span class="n">loads</span><span class="p">]</span> 
            <span class="n">params_iterator</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">params</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params_iterator</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">control_var_name</span> <span class="o">!=</span> <span class="s1">&#39;Load&#39;</span><span class="p">:</span>
                <span class="n">all_subjects</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">summary_dicts</span><span class="p">[</span><span class="n">param</span><span class="p">][</span><span class="s1">&#39;Subject&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
                <span class="n">all_rand_vars</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">summary_dicts</span><span class="p">[</span><span class="n">param</span><span class="p">][</span><span class="n">rand_var_key</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
                <span class="c1"># num entries for this load</span>
                <span class="n">num_entries</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">summary_dicts</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">summary_dicts</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;Load&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">load</span><span class="p">)</span>
                <span class="c1"># index where entries for this load start</span>
                <span class="n">starting_idx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">summary_dicts</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">summary_dicts</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;Load&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">load</span><span class="p">)</span>
                <span class="c1"># get errors</span>
                <span class="k">if</span> <span class="n">error_summary_dicts</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">all_errors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">error_summary_dicts</span><span class="p">[</span><span class="n">param</span><span class="p">][</span><span class="n">rand_var_key</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># param is the load</span>
                <span class="n">all_subjects</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">summary_dicts</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;Subject&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
                <span class="n">all_rand_vars</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">summary_dicts</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">rand_var_key</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
                <span class="c1"># num entries for this load</span>
                <span class="n">num_entries</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">summary_dicts</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;Load&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
                <span class="c1"># index where entries for this load start</span>
                <span class="n">starting_idx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">summary_dicts</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;Load&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
                <span class="c1"># get errors</span>
                <span class="k">if</span> <span class="n">error_summary_dicts</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">all_errors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">error_summary_dicts</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">rand_var_key</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">starting_idx</span><span class="p">,</span> <span class="n">starting_idx</span><span class="o">+</span><span class="n">num_entries</span><span class="p">):</span>
                <span class="n">subject</span><span class="p">,</span> <span class="n">rand_var</span> <span class="o">=</span> <span class="n">all_subjects</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">all_rand_vars</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">subject</span> <span class="ow">in</span> <span class="n">subjects_to_plot</span><span class="p">:</span>
                    <span class="n">rand_vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">all_rand_vars</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
                    <span class="n">subjects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">all_subjects</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">error_summary_dicts</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">all_errors</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">control_var_name</span> <span class="o">!=</span> <span class="s1">&#39;Load&#39;</span><span class="p">:</span>
                        <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>

        <span class="c1"># organise into plot_dict</span>
        <span class="k">if</span> <span class="n">error_summary_dicts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plot_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">_class</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x_values&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;y_values&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;rand_vars&#39;</span><span class="p">:</span> <span class="p">[]}</span> <span class="k">for</span> <span class="n">_class</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">subjects</span><span class="p">)}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plot_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">_class</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x_values&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;y_values&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;rand_vars&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;errors&#39;</span><span class="p">:</span> <span class="p">[]}</span> <span class="k">for</span> <span class="n">_class</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">subjects</span><span class="p">)}</span>
        <span class="c1"># for subject, rand_var, param in zip(subjects, rand_vars, params):</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">subjects</span><span class="p">)):</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">subjects</span><span class="p">[</span><span class="n">idx</span><span class="p">]][</span><span class="s1">&#39;x_values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="n">idx</span><span class="p">]))</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">subjects</span><span class="p">[</span><span class="n">idx</span><span class="p">]][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rand_vars</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">subjects</span><span class="p">[</span><span class="n">idx</span><span class="p">]][</span><span class="s1">&#39;rand_vars&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rand_vars</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">error_summary_dicts</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">plot_dict</span><span class="p">[</span><span class="n">subjects</span><span class="p">[</span><span class="n">idx</span><span class="p">]][</span><span class="s1">&#39;errors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">errors</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;replace_summary_dict_dependent_var_name&#39;</span><span class="p">]:</span>
            <span class="n">rand_var_key</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">dependent_var_display_name</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">control_var_name</span> <span class="o">!=</span> <span class="s1">&#39;Load&#39;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Load </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">load</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">error_bar_axis</span> <span class="o">=</span> <span class="kc">None</span>
    
        <span class="c1"># scatter</span>
        <span class="k">if</span> <span class="n">error_summary_dicts</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">error_bar_axis</span> <span class="o">=</span> <span class="s1">&#39;yerr&#39;</span>
        <span class="n">fig1</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_scatter</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                           <span class="n">xlabel</span><span class="o">=</span><span class="n">control_var_name</span><span class="p">,</span> 
                                           <span class="c1"># ylabel=&#39;Load {} &#39;.format(load)+rand_var_key,</span>
                                           <span class="n">ylabel</span><span class="o">=</span><span class="n">dependent_var_display_name</span><span class="p">,</span>
                                           <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                                           <span class="n">ghost_classes</span><span class="o">=</span><span class="n">ghost_subjects</span><span class="p">,</span>
                                           <span class="n">plot_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                           <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span>
                                           <span class="n">error_bar_axis</span><span class="o">=</span><span class="n">error_bar_axis</span><span class="p">,</span>
                                           <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span>
                                           <span class="n">use_scientific_notation_yaxis</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;use_scientific_notation&#39;</span><span class="p">],</span>
                                           <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">],</span>
                                           <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                           <span class="n">ylogscale</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">],</span>
                                           <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span>
                                           <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># complementary cdf</span>
        <span class="n">fig2</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_cdf</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                       <span class="n">xlabel</span><span class="o">=</span><span class="n">dependent_var_display_name</span><span class="p">,</span> 
                                       <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;C-CDF&#39;</span><span class="p">,</span> 
                                       <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                                       <span class="n">ghost_classes</span><span class="o">=</span><span class="n">ghost_subjects</span><span class="p">,</span>
                                       <span class="n">complementary_cdf</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                       <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span>
                                       <span class="n">use_scientific_notation</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;use_scientific_notation&#39;</span><span class="p">],</span>
                                       <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span>
                                       <span class="n">logscale</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;logscale&#39;</span><span class="p">],</span>
                                       <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cdf_figsize&#39;</span><span class="p">],</span>
                                       <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                       <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span>
                                       <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># % change</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">plot_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">init_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;x_values&#39;</span><span class="p">])</span>
            <span class="n">init_var</span> <span class="o">=</span> <span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">][</span><span class="n">init_idx</span><span class="p">]</span>
            <span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">init_var</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;y_values&#39;</span><span class="p">]))]</span>
        <span class="k">if</span> <span class="s1">&#39;(&#39;</span> <span class="ow">in</span> <span class="n">dependent_var_display_name</span><span class="p">:</span>
            <span class="c1"># remove units since this y-axis label will be a fraction</span>
            <span class="n">_dependent_var_display_name</span> <span class="o">=</span> <span class="n">dependent_var_display_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; (&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_dependent_var_display_name</span> <span class="o">=</span> <span class="n">dependent_var_display_name</span>
        <span class="n">fig3</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_scatter</span><span class="p">(</span><span class="n">plot_dict</span><span class="o">=</span><span class="n">plot_dict</span><span class="p">,</span> 
                                           <span class="n">xlabel</span><span class="o">=</span><span class="n">control_var_name</span><span class="p">,</span> 
                                           <span class="c1"># ylabel=&#39;Load {} &#39;.format(load)+&#39;\u0394F {}&#39;.format(dependent_var_name), </span>
                                           <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\u0394</span><span class="s1">F </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_dependent_var_display_name</span><span class="p">),</span> 
                                           <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                                           <span class="n">error_bar_axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># cant do error for % change since calc from mean</span>
                                           <span class="n">ghost_classes</span><span class="o">=</span><span class="n">ghost_subjects</span><span class="p">,</span>
                                           <span class="n">gridlines</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gridlines&#39;</span><span class="p">],</span> 
                                           <span class="n">aspect</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;aspect&#39;</span><span class="p">],</span> 
                                           <span class="n">plot_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                           <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scatter_figsize&#39;</span><span class="p">],</span> 
                                           <span class="n">use_scientific_notation_yaxis</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                           <span class="n">font_size</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">],</span>
                                           <span class="n">ylogscale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                           <span class="n">legend_ncol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend_ncol&#39;</span><span class="p">],</span> 
                                           <span class="n">show_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">path_to_save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;/&#39;</span> <span class="ow">in</span> <span class="n">rand_var_key</span><span class="p">:</span>
                <span class="c1"># change so that save name is compatible</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="n">rand_var_key</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
                <span class="n">rand_var_key</span> <span class="o">=</span> <span class="n">rand_var_key</span><span class="p">[:</span><span class="n">idx</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">rand_var_key</span> <span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
            <span class="k">if</span> <span class="n">control_var_name</span> <span class="o">!=</span> <span class="s1">&#39;Load&#39;</span><span class="p">:</span>
                <span class="n">fig1</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/</span><span class="si">{}</span><span class="s1">_vs_</span><span class="si">{}</span><span class="s1">_load_</span><span class="si">{}</span><span class="s1">_scatter.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rand_var_key</span><span class="p">,</span> <span class="n">control_var_name</span><span class="p">,</span> <span class="n">load</span><span class="p">),</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
                <span class="n">fig2</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/</span><span class="si">{}</span><span class="s1">_vs_</span><span class="si">{}</span><span class="s1">_load_</span><span class="si">{}</span><span class="s1">_complementary_cdf.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rand_var_key</span><span class="p">,</span> <span class="n">control_var_name</span><span class="p">,</span> <span class="n">load</span><span class="p">),</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
                <span class="n">fig3</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/</span><span class="si">{}</span><span class="s1">_vs_</span><span class="si">{}</span><span class="s1">_load_</span><span class="si">{}</span><span class="s1">_change.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rand_var_key</span><span class="p">,</span> <span class="n">control_var_name</span><span class="p">,</span> <span class="n">load</span><span class="p">),</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fig1</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/</span><span class="si">{}</span><span class="s1">_vs_</span><span class="si">{}</span><span class="s1">_scatter.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rand_var_key</span><span class="p">,</span> <span class="n">control_var_name</span><span class="p">),</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
                <span class="n">fig2</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/</span><span class="si">{}</span><span class="s1">_vs_</span><span class="si">{}</span><span class="s1">_complementary_cdf.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rand_var_key</span><span class="p">,</span> <span class="n">control_var_name</span><span class="p">),</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
                <span class="n">fig3</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">path_to_save</span><span class="o">+</span><span class="s1">&#39;/</span><span class="si">{}</span><span class="s1">_vs_</span><span class="si">{}</span><span class="s1">_change.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rand_var_key</span><span class="p">,</span> <span class="n">control_var_name</span><span class="p">),</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Saved figs to </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path_to_save</span><span class="p">))</span>

        <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>


    <span class="k">return</span> <span class="p">[</span><span class="n">fig1</span><span class="p">,</span> <span class="n">fig2</span><span class="p">,</span> <span class="n">fig3</span><span class="p">]</span></div>





</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Christopher W. F. Parsonson

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>