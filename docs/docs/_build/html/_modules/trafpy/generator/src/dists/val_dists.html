

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>trafpy.generator.src.dists.val_dists &mdash; TrafPy 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/underscore.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
        <script src="../../../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../../index.html" class="icon icon-home"> TrafPy
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../Install.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../Tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../License.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../Citing.html">Citing</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">TrafPy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../../index.html">Module code</a> &raquo;</li>
        
      <li>trafpy.generator.src.dists.val_dists</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for trafpy.generator.src.dists.val_dists</h1><div class="highlight"><pre>
<span></span><span class="sd">&#39;&#39;&#39;Module for generating value distributions.&#39;&#39;&#39;</span>

<span class="kn">from</span> <span class="nn">trafpy.generator.src.dists</span> <span class="kn">import</span> <span class="n">plot_dists</span> 
<span class="kn">from</span> <span class="nn">trafpy.generator.src</span> <span class="kn">import</span> <span class="n">tools</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">skewnorm</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">interactive_output</span><span class="p">,</span> <span class="n">interact_manual</span><span class="p">,</span> <span class="n">fixed</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">clear_output</span>


<div class="viewcode-block" id="convert_key_occurrences_to_data"><a class="viewcode-back" href="../../../../../trafpy.generator.src.dists.html#trafpy.generator.src.dists.val_dists.convert_key_occurrences_to_data">[docs]</a><span class="k">def</span> <span class="nf">convert_key_occurrences_to_data</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">num_occurrences</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Converts value keys and their number of occurrences into random vars.</span>

<span class="sd">    Args:</span>
<span class="sd">        keys (list): Random variable values.</span>
<span class="sd">        num_occurrences (list): Number of each random variable to generate.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: Random variables generated.</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">num_occurrences</span><span class="p">[</span><span class="n">idx</span><span class="p">]:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">data</span></div>


<div class="viewcode-block" id="convert_data_to_key_occurrences"><a class="viewcode-back" href="../../../../../trafpy.generator.src.dists.html#trafpy.generator.src.dists.val_dists.convert_data_to_key_occurrences">[docs]</a><span class="k">def</span> <span class="nf">convert_data_to_key_occurrences</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Converts random variable data into value keys and corresponding occurrences.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (list): Random variables to convert into key-num_occurrences pairs.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: Random variable value - number of occurrences key-value pairs </span>
<span class="sd">        generated from random variable data.</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># count number of times each var occurs in data</span>
    <span class="n">counter_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">counter_dict</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="c1"># not yet encountered var val</span>
            <span class="n">counter_dict</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">counter_dict</span></div>

    

<div class="viewcode-block" id="x_round"><a class="viewcode-back" href="../../../../../trafpy.generator.src.dists.html#trafpy.generator.src.dists.val_dists.x_round">[docs]</a><span class="k">def</span> <span class="nf">x_round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">round_to_nearest</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_decimal_places</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">print_data</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Rounds variable to nearest specified value.&#39;&#39;&#39;</span>
    <span class="n">factor</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">round_to_nearest</span><span class="p">,</span> <span class="n">num_decimal_places</span><span class="p">)</span>
    <span class="n">rounded</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">factor</span><span class="p">)</span><span class="o">/</span><span class="n">factor</span><span class="p">,</span> <span class="n">num_decimal_places</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">print_data</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Original val: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Round to nearest: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">round_to_nearest</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Rounded val: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rounded</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">rounded</span></div>
    

<div class="viewcode-block" id="gen_uniform_val_dist"><a class="viewcode-back" href="../../../../../trafpy.generator.src.dists.html#trafpy.generator.src.dists.val_dists.gen_uniform_val_dist">[docs]</a><span class="k">def</span> <span class="nf">gen_uniform_val_dist</span><span class="p">(</span><span class="n">min_val</span><span class="p">,</span>
                         <span class="n">max_val</span><span class="p">,</span>
                         <span class="n">round_to_nearest</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">num_decimal_places</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                         <span class="n">occurrence_multiplier</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                         <span class="n">path_to_save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">plot_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                         <span class="n">show_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                         <span class="n">return_data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                         <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">logscale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                         <span class="n">rand_var_name</span><span class="o">=</span><span class="s1">&#39;Random Variable&#39;</span><span class="p">,</span>
                         <span class="n">prob_rand_var_less_than</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">num_bins</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                         <span class="n">print_data</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Generates a uniform distribution of random variable values.</span>

<span class="sd">    Uniform distributions are the most simple distribution. Each random variable</span>
<span class="sd">    value in a uniform distribution has an equal probability of occurring.</span>

<span class="sd">    Args:</span>
<span class="sd">        min_val (int/float): Minimum random variable value.</span>
<span class="sd">        max_val (int/float): Maximum random variable value.</span>
<span class="sd">        round_to_nearest (int/float): Value to round random variables to nearest.</span>
<span class="sd">            E.g. if round_to_nearest=0.2, will round each random variable to </span>
<span class="sd">            nearest 0.2.</span>
<span class="sd">        num_decimal_places (int): Number of decimal places to random variable</span>
<span class="sd">            values. Need to explicitly state otherwise Python&#39;s floating point </span>
<span class="sd">            arithmetic will cause spurious unique random variable value errors</span>
<span class="sd">            when discretising.</span>
<span class="sd">        occurrence_multiplier (int/float): When sampling random variables from</span>
<span class="sd">            distribution to create plot and random variable data, use this</span>
<span class="sd">            multiplier to determine number of data points to sample. A higher </span>
<span class="sd">            value will cause the random variable data to match the probability</span>
<span class="sd">            distribution more closely, but will take longer to generate.</span>
<span class="sd">        path_to_save (str): Path to directory (with file name included) in which</span>
<span class="sd">            to save generated distribution. E.g. path_to_save=&#39;data/dists/my_dist&#39;.</span>
<span class="sd">        plot_fig (bool): Whether or not to plot fig. If True, will return fig.</span>
<span class="sd">        show_fig (bool): Whether or not to plot and show fig. If True, will</span>
<span class="sd">            return and display fig.</span>
<span class="sd">        return_data (bool) Whether or not to return random variable data sampled</span>
<span class="sd">            from generated distribution.</span>
<span class="sd">        xlim (list): X-axis limits of plot. E.g. xlim=[0,10] to plot random</span>
<span class="sd">            variable values between 0 and 10.</span>
<span class="sd">        logscale (bool): Whether or not plot should have logscale x-axis and bins.</span>
<span class="sd">        rand_var_name (str): Name of random variable to label plot&#39;s x-axis.</span>
<span class="sd">        prob_rand_var_less_than (list): List of values for which to print the</span>
<span class="sd">            probability that a variable sampled randomly from the generated </span>
<span class="sd">            distribution will be less than. This is useful for replicating </span>
<span class="sd">            distributions from the literature. E.g. prob_rand_var_less_than=[3.7,5.8]</span>
<span class="sd">            will return the probability that a randomly chosen variable is less</span>
<span class="sd">            than 3.7 and 5.8 respectively.</span>
<span class="sd">        num_bins (int): Number of bins to use in plot. Default is 0, in which</span>
<span class="sd">            case the number of bins chosen will be automatically selected.</span>
<span class="sd">        print_data (bool): whether or not to print extra information about the</span>
<span class="sd">            generated data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: Tuple containing:</span>
<span class="sd">            - **prob_dist** (*dict*): Probability distribution whose key-value pairs are </span>
<span class="sd">              random variable value-probability pairs. </span>
<span class="sd">            - **rand_vars** (*list, optional*): Random variable values sampled from the </span>
<span class="sd">              generated probability distribution. To return, set return_data=True.</span>
<span class="sd">            - **fig** (*matplotlib.figure.Figure, optional*): Probability density </span>
<span class="sd">              and cumulative distribution function plot. To return, set show_fig=True </span>
<span class="sd">              and/or plot_fig=True.</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">round_to_nearest</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># assume separation between vals is 1 unit</span>
        <span class="n">separation</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># separation between vals is same as round to nearest</span>
        <span class="n">separation</span> <span class="o">=</span> <span class="n">round_to_nearest</span>

    <span class="n">unique_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="o">+</span><span class="n">separation</span><span class="p">,</span> <span class="n">separation</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">round_to_nearest</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">unique_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_round</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="n">round_to_nearest</span><span class="p">,</span><span class="n">num_decimal_places</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">unique_vals</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># no need to discretise</span>
        <span class="k">pass</span>
    <span class="n">probabilities</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_vals</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_vals</span><span class="p">))]</span>

    <span class="n">prob_dist</span> <span class="o">=</span> <span class="p">{</span><span class="n">unique_val</span><span class="p">:</span> <span class="n">prob</span> <span class="k">for</span> <span class="n">unique_val</span><span class="p">,</span> <span class="n">prob</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">unique_vals</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">)}</span>
    
    <span class="k">if</span> <span class="n">print_data</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Prob dist:</span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prob_dist</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">path_to_save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">tools</span><span class="o">.</span><span class="n">pickle_data</span><span class="p">(</span><span class="n">path_to_save</span><span class="p">,</span> <span class="n">node_dist</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">plot_fig</span> <span class="ow">or</span> <span class="n">show_fig</span><span class="p">:</span>
        <span class="n">min_prob</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">prob</span> <span class="k">for</span> <span class="n">prob</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">prob_dist</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="k">if</span> <span class="n">prob</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">num_occurrences</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">min_prob</span><span class="p">)</span><span class="o">*</span><span class="n">occurrence_multiplier</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">prob_dist</span><span class="o">.</span><span class="n">values</span><span class="p">())]</span>
        <span class="n">rand_vars</span> <span class="o">=</span> <span class="n">convert_key_occurrences_to_data</span><span class="p">(</span><span class="n">unique_vals</span><span class="p">,</span><span class="n">num_occurrences</span><span class="p">)</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_dist</span><span class="p">(</span><span class="n">rand_vars</span><span class="o">=</span><span class="n">rand_vars</span><span class="p">,</span> 
                                       <span class="n">xlim</span><span class="o">=</span><span class="n">xlim</span><span class="p">,</span>
                                       <span class="n">logscale</span><span class="o">=</span><span class="n">logscale</span><span class="p">,</span>
                                       <span class="n">rand_var_name</span><span class="o">=</span><span class="n">rand_var_name</span><span class="p">,</span>
                                       <span class="n">prob_rand_var_less_than</span><span class="o">=</span><span class="n">prob_rand_var_less_than</span><span class="p">,</span>
                                       <span class="n">num_bins</span><span class="o">=</span><span class="n">num_bins</span><span class="p">,</span>
                                       <span class="n">show_fig</span><span class="o">=</span><span class="n">show_fig</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">return_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">prob_dist</span><span class="p">,</span> <span class="n">rand_vars</span><span class="p">,</span> <span class="n">fig</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">prob_dist</span><span class="p">,</span> <span class="n">fig</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">return_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">prob_dist</span><span class="p">,</span> <span class="n">rand_vars</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">prob_dist</span></div>
    
<div class="viewcode-block" id="gen_skew_dists"><a class="viewcode-back" href="../../../../../trafpy.generator.src.dists.html#trafpy.generator.src.dists.val_dists.gen_skew_dists">[docs]</a><span class="k">def</span> <span class="nf">gen_skew_dists</span><span class="p">(</span><span class="n">min_val</span><span class="p">,</span>
                   <span class="n">max_val</span><span class="p">,</span>
                   <span class="n">num_modes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                   <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">rand_var_name</span><span class="o">=</span><span class="s1">&#39;Unknown&#39;</span><span class="p">,</span>
                   <span class="n">round_to_nearest</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">num_decimal_places</span><span class="o">=</span><span class="mf">0.2</span><span class="p">):</span>
    
    <span class="c1"># initialise widget and data dicts</span>
    <span class="n">widget_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">mode_iter</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;num_bins_widget&#39;</span><span class="p">:</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntText</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;bins:&#39;</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
                               <span class="s1">&#39;num_samples_widget&#39;</span><span class="p">:</span> <span class="n">widgets</span><span class="o">.</span><span class="n">BoundedIntText</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Samples:&#39;</span><span class="p">,</span><span class="nb">min</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="nb">max</span><span class="o">=</span><span class="mi">30000</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span><span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
                               <span class="s1">&#39;loc_widget&#39;</span><span class="p">:</span> <span class="n">widgets</span><span class="o">.</span><span class="n">BoundedIntText</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Location:&#39;</span><span class="p">,</span><span class="nb">min</span><span class="o">=</span><span class="n">min_val</span><span class="p">,</span><span class="nb">max</span><span class="o">=</span><span class="n">max_val</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="n">max_val</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
                               <span class="s1">&#39;skew_widget&#39;</span><span class="p">:</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatText</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Skew:&#39;</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
                               <span class="s1">&#39;scale_widget&#39;</span><span class="p">:</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatText</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Scale:&#39;</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">,)}</span>
                               <span class="k">for</span> <span class="n">mode_iter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_modes</span><span class="p">)}</span>
    <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">mode_iter</span><span class="p">:</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">mode_iter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_modes</span><span class="p">)}</span>
    
    <span class="c1"># customise skews</span>
    <span class="n">locations</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_modes</span><span class="p">)]</span>
    <span class="n">skews</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_modes</span><span class="p">)]</span>
    <span class="n">scales</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_modes</span><span class="p">)]</span>
    <span class="n">num_skew_samples</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_modes</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">mode_iter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_modes</span><span class="p">):</span>
        <span class="n">data_dict</span><span class="p">[</span><span class="n">mode_iter</span><span class="p">]</span> <span class="o">=</span> <span class="n">interactive</span><span class="p">(</span><span class="n">gen_skew_data</span><span class="p">,</span> 
                                           <span class="p">{</span><span class="s1">&#39;manual&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
                                           <span class="n">num_bins</span><span class="o">=</span><span class="n">widget_dict</span><span class="p">[</span><span class="n">mode_iter</span><span class="p">][</span><span class="s1">&#39;num_bins_widget&#39;</span><span class="p">],</span>
                                           <span class="n">num_skew_samples</span><span class="o">=</span><span class="n">widget_dict</span><span class="p">[</span><span class="n">mode_iter</span><span class="p">][</span><span class="s1">&#39;num_samples_widget&#39;</span><span class="p">],</span>
                                           <span class="n">location</span><span class="o">=</span><span class="n">widget_dict</span><span class="p">[</span><span class="n">mode_iter</span><span class="p">][</span><span class="s1">&#39;loc_widget&#39;</span><span class="p">],</span>
                                           <span class="n">skew</span><span class="o">=</span><span class="n">widget_dict</span><span class="p">[</span><span class="n">mode_iter</span><span class="p">][</span><span class="s1">&#39;skew_widget&#39;</span><span class="p">],</span>
                                           <span class="n">scale</span><span class="o">=</span><span class="n">widget_dict</span><span class="p">[</span><span class="n">mode_iter</span><span class="p">][</span><span class="s1">&#39;scale_widget&#39;</span><span class="p">],</span>
                                           <span class="n">min_val</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="n">min_val</span><span class="p">),</span>
                                           <span class="n">max_val</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="n">max_val</span><span class="p">),</span>
                                           <span class="n">xlim</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="n">xlim</span><span class="p">),</span>
                                           <span class="n">rand_var_name</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="n">rand_var_name</span><span class="p">),</span>
                                           <span class="n">round_to_nearest</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="n">round_to_nearest</span><span class="p">),</span>
                                           <span class="n">num_decimal_places</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="n">num_decimal_places</span><span class="p">))</span>

        
        <span class="c1"># DISPLAY</span>
        <span class="n">display</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="n">mode_iter</span><span class="p">])</span>
    
    <span class="k">return</span> <span class="n">data_dict</span></div>


<div class="viewcode-block" id="gen_skew_data"><a class="viewcode-back" href="../../../../../trafpy.generator.src.dists.html#trafpy.generator.src.dists.val_dists.gen_skew_data">[docs]</a><span class="k">def</span> <span class="nf">gen_skew_data</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> 
                  <span class="n">skew</span><span class="p">,</span> 
                  <span class="n">scale</span><span class="p">,</span> 
                  <span class="n">min_val</span><span class="p">,</span>
                  <span class="n">max_val</span><span class="p">,</span>
                  <span class="n">num_skew_samples</span><span class="p">,</span>
                  <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                  <span class="n">logscale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">rand_var_name</span><span class="o">=</span><span class="s1">&#39;Unknown&#39;</span><span class="p">,</span>
                  <span class="n">num_bins</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                  <span class="n">round_to_nearest</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">num_decimal_places</span><span class="o">=</span><span class="mf">0.2</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Generates and plots skewed data for interactive multimodal distributions.</span>

<span class="sd">    Args:</span>
<span class="sd">        location (int/float): Position value of skewed distribution (mean shape</span>
<span class="sd">            parameter).</span>
<span class="sd">        skew (int/float): Skew value of skewed distribution (skewness shape</span>
<span class="sd">            parameter).</span>
<span class="sd">        scale (int/float): Scale value of skewed distribution (standard deviation</span>
<span class="sd">        scale (int/float): Scale value of skewed distribution (standard deviation</span>
<span class="sd">            shape parameter).</span>
<span class="sd">            shape parameter).</span>
<span class="sd">        num_skew_samples (int): Number of random variables to sample from distribution</span>
<span class="sd">            to generate skew data and plot.</span>
<span class="sd">        xlim (list): X-axis limits of plot. E.g. xlim=[0,10] to plot random</span>
<span class="sd">            variable values between 0 and 10.</span>
<span class="sd">        logscale (bool): Whether or not plot should have logscale x-axis and bins.</span>
<span class="sd">        transparent (bool): Whether or not to make plot bins slightly transparent.</span>
<span class="sd">        rand_var_name (str): Name of random variable to label plot&#39;s x-axis.</span>
<span class="sd">        num_bins (int): Number of bins to use in plot. Default is 0, in which</span>
<span class="sd">            case the number of bins chosen will be automatically selected.</span>
<span class="sd">        round_to_nearest (int/float): Value to round random variables to nearest.</span>
<span class="sd">            E.g. if round_to_nearest=0.2, will round each random variable to </span>
<span class="sd">            nearest 0.2.</span>
<span class="sd">        num_decimal_places (int): Number of decimal places to random variable</span>
<span class="sd">            values. Need to explicitly state otherwise Python&#39;s floating point </span>
<span class="sd">            arithmetic will cause spurious unique random variable value errors</span>
<span class="sd">            when discretising.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: Random variable values sampled from distribution.</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">skew_data</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="n">data</span> <span class="o">=</span> <span class="n">gen_skewnorm_data</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">skew</span><span class="p">,</span>
                             <span class="n">loc</span><span class="o">=</span><span class="n">location</span><span class="p">,</span>
                             <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span>
                             <span class="n">min_val</span><span class="o">=</span><span class="n">min_val</span><span class="p">,</span>
                             <span class="n">max_val</span><span class="o">=</span><span class="n">max_val</span><span class="p">,</span>
                             <span class="n">num_samples</span><span class="o">=</span><span class="n">num_skew_samples</span><span class="p">)</span>
    <span class="n">skew_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
    
    <span class="n">skew_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">skew_data</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span> <span class="c1"># flatten</span>
    <span class="k">if</span> <span class="n">round_to_nearest</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># discretise</span>
        <span class="n">skew_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_round</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">round_to_nearest</span><span class="p">,</span><span class="n">num_decimal_places</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">skew_data</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="n">data_description</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">skew_data</span><span class="p">)</span> 
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Characteristics of generated distribution:</span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data_description</span><span class="p">))</span>
    
    <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_dist</span><span class="p">(</span><span class="n">skew_data</span><span class="p">,</span> 
                             <span class="n">xlim</span><span class="o">=</span><span class="n">xlim</span><span class="p">,</span> 
                             <span class="n">logscale</span><span class="o">=</span><span class="n">logscale</span><span class="p">,</span>
                             <span class="n">transparent</span><span class="o">=</span><span class="n">transparent</span><span class="p">,</span>
                             <span class="n">rand_var_name</span><span class="o">=</span><span class="n">rand_var_name</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">skew_data</span></div>

<div class="viewcode-block" id="combine_multiple_mode_dists"><a class="viewcode-back" href="../../../../../trafpy.generator.src.dists.html#trafpy.generator.src.dists.val_dists.combine_multiple_mode_dists">[docs]</a><span class="k">def</span> <span class="nf">combine_multiple_mode_dists</span><span class="p">(</span><span class="n">data_dict</span><span class="p">,</span>
                                <span class="n">min_val</span><span class="p">,</span>
                                <span class="n">max_val</span><span class="p">,</span>
                                <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">rand_var_name</span><span class="o">=</span><span class="s1">&#39;Unknown&#39;</span><span class="p">,</span>
                                <span class="n">round_to_nearest</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">num_decimal_places</span><span class="o">=</span><span class="mf">0.2</span><span class="p">):</span>
    <span class="n">bg_factor</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatText</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">num_bins_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntText</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;bins:&#39;</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    
    <span class="n">prob_dist</span> <span class="o">=</span> <span class="n">interactive</span><span class="p">(</span><span class="n">combine_skews</span><span class="p">,</span>
                           <span class="p">{</span><span class="s1">&#39;manual&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
                           <span class="n">min_val</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="n">min_val</span><span class="p">),</span>
                           <span class="n">max_val</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="n">max_val</span><span class="p">),</span>
                           <span class="n">data_dict</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="n">data_dict</span><span class="p">),</span> 
                           <span class="n">bg_factor</span><span class="o">=</span><span class="n">bg_factor</span><span class="p">,</span>
                           <span class="n">xlim</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="n">xlim</span><span class="p">),</span>
                           <span class="n">rand_var_name</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="n">rand_var_name</span><span class="p">),</span>
                           <span class="n">num_bins</span><span class="o">=</span><span class="n">num_bins_widget</span><span class="p">,</span>
                           <span class="n">round_to_nearest</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="n">round_to_nearest</span><span class="p">),</span>
                           <span class="n">num_decimal_places</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="n">num_decimal_places</span><span class="p">))</span>
    
    <span class="c1"># DISPLAY</span>
    <span class="n">display</span><span class="p">(</span><span class="n">prob_dist</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">prob_dist</span></div>

<div class="viewcode-block" id="combine_skews"><a class="viewcode-back" href="../../../../../trafpy.generator.src.dists.html#trafpy.generator.src.dists.val_dists.combine_skews">[docs]</a><span class="k">def</span> <span class="nf">combine_skews</span><span class="p">(</span><span class="n">data_dict</span><span class="p">,</span> 
                  <span class="n">min_val</span><span class="p">,</span>
                  <span class="n">max_val</span><span class="p">,</span>
                  <span class="n">bg_factor</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                  <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">logscale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">rand_var_name</span><span class="o">=</span><span class="s1">&#39;Unknown&#39;</span><span class="p">,</span>
                  <span class="n">num_bins</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                  <span class="n">round_to_nearest</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">num_decimal_places</span><span class="o">=</span><span class="mf">0.2</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Combines multiple probability distributions for multimodal plotting.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_dict (dict): Keys are mode iterations, values are random variable</span>
<span class="sd">            values for the mode iteration.</span>
<span class="sd">        min_val (int/float): Minimum random variable value.</span>
<span class="sd">        max_val (int/float): Maximum random variable value.</span>
<span class="sd">        bg_factor (int/float): Factor used to determine amount of noise to add</span>
<span class="sd">            amongst shaped modes being combined. Higher factor will add more</span>
<span class="sd">            noise to distribution and make modes more connected, lower will</span>
<span class="sd">            reduce noise but make nodes less connected.</span>
<span class="sd">        xlim (list): X-axis limits of plot. E.g. xlim=[0,10] to plot random</span>
<span class="sd">            variable values between 0 and 10.</span>
<span class="sd">        logscale (bool): Whether or not plot should have logscale x-axis and bins.</span>
<span class="sd">        rand_var_name (str): Name of random variable to label plot&#39;s x-axis.</span>
<span class="sd">        num_bins (int): Number of bins to use in plot. Default is 0, in which</span>
<span class="sd">            case the number of bins chosen will be automatically selected.</span>
<span class="sd">        round_to_nearest (int/float): Value to round random variables to nearest.</span>
<span class="sd">            E.g. if round_to_nearest=0.2, will round each random variable to </span>
<span class="sd">            nearest 0.2.</span>
<span class="sd">        num_decimal_places (int): Number of decimal places to random variable</span>
<span class="sd">            values. Need to explicitly state otherwise Python&#39;s floating point </span>
<span class="sd">            arithmetic will cause spurious unique random variable value errors</span>
<span class="sd">            when discretising.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: Probability distribution whose key-value pairs are </span>
<span class="sd">        random variable value-probability pairs. </span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">locations</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">skews</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">scales</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">num_skew_samples</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">mode_iter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Chosen skew </span><span class="si">{}</span><span class="s1"> stats: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mode_iter</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">data_dict</span><span class="p">[</span><span class="n">mode_iter</span><span class="p">]</span><span class="o">.</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="n">locations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="n">mode_iter</span><span class="p">]</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">])</span>
        <span class="n">skews</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="n">mode_iter</span><span class="p">]</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;skew&#39;</span><span class="p">])</span>
        <span class="n">scales</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="n">mode_iter</span><span class="p">]</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">])</span>
        <span class="n">num_skew_samples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="n">mode_iter</span><span class="p">]</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;num_skew_samples&#39;</span><span class="p">])</span>
    
    <span class="n">prob_dist</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">gen_multimodal_val_dist</span><span class="p">(</span><span class="n">min_val</span><span class="o">=</span><span class="n">min_val</span><span class="p">,</span>
                                                  <span class="n">max_val</span><span class="o">=</span><span class="n">max_val</span><span class="p">,</span>
                                                  <span class="n">locations</span><span class="o">=</span><span class="n">locations</span><span class="p">,</span> 
                                                  <span class="n">skews</span><span class="o">=</span><span class="n">skews</span><span class="p">,</span> 
                                                  <span class="n">scales</span><span class="o">=</span><span class="n">scales</span><span class="p">,</span> 
                                                  <span class="n">bg_factor</span><span class="o">=</span><span class="n">bg_factor</span><span class="p">,</span>
                                                  <span class="n">num_skew_samples</span><span class="o">=</span><span class="n">num_skew_samples</span><span class="p">,</span>
                                                  <span class="n">round_to_nearest</span><span class="o">=</span><span class="n">round_to_nearest</span><span class="p">,</span>
                                                  <span class="n">logscale</span><span class="o">=</span><span class="n">logscale</span><span class="p">,</span>
                                                  <span class="n">return_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                  <span class="n">plot_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                  <span class="n">num_bins</span><span class="o">=</span><span class="n">num_bins</span><span class="p">,</span>
                                                  <span class="n">num_decimal_places</span><span class="o">=</span><span class="n">num_decimal_places</span><span class="p">)</span>
    
    <span class="n">data_description</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> 
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Characteristics of generated distribution:</span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data_description</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">prob_dist</span></div>


<div class="viewcode-block" id="gen_multimodal_val_dist"><a class="viewcode-back" href="../../../../../trafpy.generator.src.dists.html#trafpy.generator.src.dists.val_dists.gen_multimodal_val_dist">[docs]</a><span class="k">def</span> <span class="nf">gen_multimodal_val_dist</span><span class="p">(</span><span class="n">min_val</span><span class="p">,</span>
                            <span class="n">max_val</span><span class="p">,</span>
                            <span class="n">locations</span><span class="o">=</span><span class="p">[],</span>
                            <span class="n">skews</span><span class="o">=</span><span class="p">[],</span>
                            <span class="n">scales</span><span class="o">=</span><span class="p">[],</span>
                            <span class="n">num_skew_samples</span><span class="o">=</span><span class="p">[],</span>
                            <span class="n">bg_factor</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                            <span class="n">round_to_nearest</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">num_decimal_places</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                            <span class="n">occurrence_multiplier</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                            <span class="n">path_to_save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">plot_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">show_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">return_data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">logscale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">rand_var_name</span><span class="o">=</span><span class="s1">&#39;Random Variable&#39;</span><span class="p">,</span>
                            <span class="n">prob_rand_var_less_than</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">num_bins</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                            <span class="n">print_data</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Generates a multimodal distribution of random variable values.</span>

<span class="sd">    Multimodal distributions are arbitrary distributions with &gt;= 2 different</span>
<span class="sd">    modes. A multimodal distribution with 2 modes is a special case called a </span>
<span class="sd">    &#39;bimodal distribution&#39;. Bimodal distributions are the most common multi-</span>
<span class="sd">    modal distribution.</span>

<span class="sd">    E.g. Real-world scenarios of bimodal distributions: Starting salaries for</span>
<span class="sd">    lawyers, book prices, peak resaurant hours, age groups of disease victims,</span>
<span class="sd">    packet sizes in data centre networks, etc.</span>

<span class="sd">    Args:</span>
<span class="sd">        min_val (int/float): Minimum random variable value.</span>
<span class="sd">        max_val (int/float): Maximum random variable value.</span>
<span class="sd">        locations (list): Position value(s) of skewed distribution(s) (mean shape</span>
<span class="sd">            parameter).</span>
<span class="sd">        skews (list): Skew value(s) of skewed distribution(s) (skewness shape</span>
<span class="sd">            parameter).</span>
<span class="sd">        scales (list): Scale value(s) of skewed distribution(s) (standard deviation</span>
<span class="sd">            shape parameter).</span>
<span class="sd">        num_skew_samples (list): Number(s) of random variables to sample from distribution(s)</span>
<span class="sd">            to generate skew data and plot.</span>
<span class="sd">        bg_factor (int/float): Factor used to determine amount of noise to add</span>
<span class="sd">            amongst shaped modes being combined. Higher factor will add more</span>
<span class="sd">            noise to distribution and make modes more connected, lower will</span>
<span class="sd">            reduce noise but make nodes less connected.</span>
<span class="sd">        round_to_nearest (int/float): Value to round random variables to nearest.</span>
<span class="sd">            E.g. if round_to_nearest=0.2, will round each random variable to </span>
<span class="sd">            nearest 0.2.</span>
<span class="sd">        num_decimal_places (int): Number of decimal places to random variable</span>
<span class="sd">            values. Need to explicitly state otherwise Python&#39;s floating point </span>
<span class="sd">            arithmetic will cause spurious unique random variable value errors</span>
<span class="sd">            when discretising.</span>
<span class="sd">        occurrence_multiplier (int/float): When sampling random variables from</span>
<span class="sd">            distribution to create plot and random variable data, use this</span>
<span class="sd">            multiplier to determine number of data points to sample. A higher </span>
<span class="sd">            value will cause the random variable data to match the probability</span>
<span class="sd">            distribution more closely, but will take longer to generate.</span>
<span class="sd">        path_to_save (str): Path to directory (with file name included) in which</span>
<span class="sd">            to save generated distribution. E.g. path_to_save=&#39;data/dists/my_dist&#39;.</span>
<span class="sd">        plot_fig (bool): Whether or not to plot fig. If True, will return fig.</span>
<span class="sd">        show_fig (bool): Whether or not to plot and show fig. If True, will</span>
<span class="sd">        tuple</span>
<span class="sd">            return and display fig.</span>
<span class="sd">        return_data (bool) Whether or not to return random variable data sampled</span>
<span class="sd">            from generated distribution.</span>
<span class="sd">        xlim (list): X-axis limits of plot. E.g. xlim=[0,10] to plot random</span>
<span class="sd">            variable values between 0 and 10.</span>
<span class="sd">        logscale (bool): Whether or not plot should have logscale x-axis and bins.</span>
<span class="sd">        rand_var_name (str): Name of random variable to label plot&#39;s x-axis.</span>
<span class="sd">        prob_rand_var_less_than (list): List of values for which to print the</span>
<span class="sd">            probability that a variable sampled randomly from the generated </span>
<span class="sd">            distribution will be less than. This is useful for replicating </span>
<span class="sd">            distributions from the literature. E.g. prob_rand_var_less_than=[3.7,5.8]</span>
<span class="sd">            will return the probability that a randomly chosen variable is less</span>
<span class="sd">            than 3.7 and 5.8 respectively.</span>
<span class="sd">        num_bins (int): Number of bins to use in plot. Default is 0, in which</span>
<span class="sd">            case the number of bins chosen will be automatically selected.</span>
<span class="sd">        print_data (bool): Whether or not to print extra information about the</span>
<span class="sd">            generated data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: Tuple containing:</span>
<span class="sd">            - **prob_dist** (*dict*): Probability distribution whose key-value pairs are </span>
<span class="sd">              random variable value-probability pairs. </span>
<span class="sd">            - **rand_vars** (*list, optional*): Random variable values sampled from the </span>
<span class="sd">              generated probability distribution. To return, set return_data=True.</span>
<span class="sd">            - **fig** (*matplotlib.figure.Figure, optional*): Probability density </span>
<span class="sd">              and cumulative distribution function plot. To return, set show_fig=True </span>
<span class="sd">              and/or plot_fig=True.</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="n">round_to_nearest</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># assume separation between vals is 1 unit</span>
        <span class="n">separation</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># separation between vals is same as round to nearest</span>
        <span class="n">separation</span> <span class="o">=</span> <span class="n">round_to_nearest</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">num_skew_samples</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># fill in automatically</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">locations</span><span class="p">)):</span>
            <span class="n">num_skew_samples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>

    <span class="n">num_bg_samples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">num_skew_samples</span><span class="p">)</span><span class="o">*</span><span class="n">bg_factor</span><span class="p">)</span>
    <span class="n">num_modes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">locations</span><span class="p">)</span>

    <span class="n">poss_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">min_val</span><span class="p">,</span><span class="n">max_val</span><span class="o">+</span><span class="n">separation</span><span class="p">,</span><span class="n">separation</span><span class="p">)</span>
    <span class="n">baseline_probs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">poss_vals</span><span class="p">)))</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">poss_vals</span><span class="p">)</span>
    <span class="n">baseline_vals</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">poss_vals</span><span class="p">,</span>
                                          <span class="n">size</span><span class="o">=</span><span class="n">num_bg_samples</span><span class="p">,</span>
                                          <span class="n">p</span><span class="o">=</span><span class="n">baseline_probs</span><span class="p">))</span>

    <span class="n">skew_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">skew_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">baseline_vals</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">mode_iter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_modes</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">gen_skewnorm_data</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">skews</span><span class="p">[</span><span class="n">mode_iter</span><span class="p">],</span>
                                 <span class="n">loc</span><span class="o">=</span><span class="n">locations</span><span class="p">[</span><span class="n">mode_iter</span><span class="p">],</span>
                                 <span class="n">scale</span><span class="o">=</span><span class="n">scales</span><span class="p">[</span><span class="n">mode_iter</span><span class="p">],</span>
                                 <span class="n">min_val</span><span class="o">=</span><span class="n">min_val</span><span class="p">,</span>
                                 <span class="n">max_val</span><span class="o">=</span><span class="n">max_val</span><span class="p">,</span>
                                 <span class="n">num_samples</span><span class="o">=</span><span class="n">num_skew_samples</span><span class="p">[</span><span class="n">mode_iter</span><span class="p">])</span>
        <span class="n">skew_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

    <span class="n">skew_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">skew_data</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span> <span class="c1"># flatten</span>

    <span class="n">unique_vals</span><span class="p">,</span> <span class="n">pmf</span> <span class="o">=</span> <span class="n">gen_discrete_prob_dist</span><span class="p">(</span><span class="n">rand_vars</span><span class="o">=</span><span class="n">skew_data</span><span class="p">,</span> 
                                              <span class="n">round_to_nearest</span><span class="o">=</span><span class="n">round_to_nearest</span><span class="p">,</span>
                                              <span class="n">num_decimal_places</span><span class="o">=</span><span class="n">num_decimal_places</span><span class="p">)</span>
    
    <span class="n">prob_dist</span> <span class="o">=</span> <span class="p">{</span><span class="n">unique_val</span><span class="p">:</span> <span class="n">prob</span> <span class="k">for</span> <span class="n">unique_val</span><span class="p">,</span> <span class="n">prob</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">unique_vals</span><span class="p">,</span> <span class="n">pmf</span><span class="p">)}</span>
    
    <span class="k">if</span> <span class="n">print_data</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Prob dist:</span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prob_dist</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">path_to_save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">tools</span><span class="o">.</span><span class="n">pickle_data</span><span class="p">(</span><span class="n">path_to_save</span><span class="p">,</span> <span class="n">node_dist</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">plot_fig</span> <span class="ow">or</span> <span class="n">show_fig</span><span class="p">:</span>
        <span class="n">min_prob</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">prob</span> <span class="k">for</span> <span class="n">prob</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">prob_dist</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="k">if</span> <span class="n">prob</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">num_occurrences</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">min_prob</span><span class="p">)</span><span class="o">*</span><span class="n">occurrence_multiplier</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">prob_dist</span><span class="o">.</span><span class="n">values</span><span class="p">())]</span>
        <span class="n">rand_vars</span> <span class="o">=</span> <span class="n">convert_key_occurrences_to_data</span><span class="p">(</span><span class="n">unique_vals</span><span class="p">,</span><span class="n">num_occurrences</span><span class="p">)</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_dist</span><span class="p">(</span><span class="n">rand_vars</span><span class="o">=</span><span class="n">rand_vars</span><span class="p">,</span> 
                                       <span class="n">xlim</span><span class="o">=</span><span class="n">xlim</span><span class="p">,</span>
                                       <span class="n">logscale</span><span class="o">=</span><span class="n">logscale</span><span class="p">,</span>
                                       <span class="n">rand_var_name</span><span class="o">=</span><span class="n">rand_var_name</span><span class="p">,</span>
                                       <span class="n">prob_rand_var_less_than</span><span class="o">=</span><span class="n">prob_rand_var_less_than</span><span class="p">,</span>
                                       <span class="n">num_bins</span><span class="o">=</span><span class="n">num_bins</span><span class="p">,</span>
                                       <span class="n">show_fig</span><span class="o">=</span><span class="n">show_fig</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">return_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">prob_dist</span><span class="p">,</span> <span class="n">rand_vars</span><span class="p">,</span> <span class="n">fig</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">prob_dist</span><span class="p">,</span> <span class="n">fig</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">return_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">prob_dist</span><span class="p">,</span> <span class="n">rand_vars</span> 
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">prob_dist</span></div>


<div class="viewcode-block" id="gen_skewnorm_data"><a class="viewcode-back" href="../../../../../trafpy.generator.src.dists.html#trafpy.generator.src.dists.val_dists.gen_skewnorm_data">[docs]</a><span class="k">def</span> <span class="nf">gen_skewnorm_data</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Generates skew data.</span>

<span class="sd">    Args:</span>
<span class="sd">        a (int/float): Skewness shape parameter. When a=0, distribution is</span>
<span class="sd">            identical to a normal distribution.</span>
<span class="sd">        loc (int/float): Position value of skewed distribution (mean shape</span>
<span class="sd">            parameter).</span>
<span class="sd">        scale (int/float): Scale value of skewed distribution (standard deviation</span>
<span class="sd">            shape parameter).</span>
<span class="sd">        min_val (int/float): Minimum random variable value.</span>
<span class="sd">        max_val (int/float): Maximum random variable value.</span>
<span class="sd">        num_samples (int): Number of values to sample from generated distribution</span>
<span class="sd">            to generate skew data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: List of random variable values sampled from skewed distribution.</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">skewnorm</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">num_samples</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">data_iter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">data</span><span class="p">[</span><span class="n">data_iter</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">min_val</span> <span class="ow">or</span> <span class="n">data</span><span class="p">[</span><span class="n">data_iter</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">max_val</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">data_iter</span><span class="p">]</span> <span class="o">=</span> <span class="n">skewnorm</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">counter</span> <span class="o">&gt;</span> <span class="mi">10000</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s1">&#39;scale too high for required max-min range&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span></div>


<div class="viewcode-block" id="gen_rand_vars_from_discretised_dist"><a class="viewcode-back" href="../../../../../trafpy.generator.src.dists.html#trafpy.generator.src.dists.val_dists.gen_rand_vars_from_discretised_dist">[docs]</a><span class="k">def</span> <span class="nf">gen_rand_vars_from_discretised_dist</span><span class="p">(</span><span class="n">unique_vars</span><span class="p">,</span> 
                                        <span class="n">probabilities</span><span class="p">,</span> 
                                        <span class="n">num_demands</span><span class="p">,</span>
                                        <span class="n">path_to_save</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Generates random variable values by sampling from a discretised distribution.</span>

<span class="sd">    Args:</span>
<span class="sd">        unique_vars (list): Possible random variable values.</span>
<span class="sd">        probabilities (list): Corresponding probabilities of each random variable</span>
<span class="sd">            value being chosen.</span>
<span class="sd">        num_demands (int): Number of random variables to sample.</span>
<span class="sd">        path_to_save (str): Path to directory (with file name included) in which</span>
<span class="sd">            to save generated data. E.g. path_to_save=&#39;data/my_data&#39;</span>

<span class="sd">    Returns:</span>
<span class="sd">        numpy array: Random variable values sampled from dist.</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">sampled_vars</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">unique_vars</span><span class="p">,</span> 
                                    <span class="n">size</span><span class="o">=</span><span class="n">num_demands</span><span class="p">,</span>
                                    <span class="n">p</span><span class="o">=</span><span class="n">probabilities</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">path_to_save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">tools</span><span class="o">.</span><span class="n">pickle_data</span><span class="p">(</span><span class="n">path_to_save</span><span class="p">,</span> <span class="n">sampled_vars</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">sampled_vars</span></div>


<div class="viewcode-block" id="gen_val_dist_data"><a class="viewcode-back" href="../../../../../trafpy.generator.src.dists.html#trafpy.generator.src.dists.val_dists.gen_val_dist_data">[docs]</a><span class="k">def</span> <span class="nf">gen_val_dist_data</span><span class="p">(</span><span class="n">val_dist</span><span class="p">,</span> 
                      <span class="n">min_val</span><span class="p">,</span> 
                      <span class="n">max_val</span><span class="p">,</span> 
                      <span class="n">num_vals_to_gen</span><span class="p">,</span>
                      <span class="n">path_to_save</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Generates values between min_val and max_val following val_dist distribution&#39;&#39;&#39;</span>
    <span class="n">array_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">val_dist</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">array_sum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> \
        <span class="s1">&#39;array must sum to 1, but is </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">array_sum</span><span class="p">)</span>
    
    <span class="n">poss_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_vals_to_gen</span><span class="p">))</span>
    
    <span class="c1"># do multinomial exp to get number of each val</span>
    <span class="n">counter_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multinomial</span><span class="p">(</span><span class="n">num_vals_to_gen</span><span class="p">,</span> 
                                          <span class="n">val_dist</span><span class="p">,</span> 
                                          <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># fill out vals array</span>
    <span class="n">prev_val_iter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="nb">iter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nditer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">poss_vals</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">num_vals</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">counter_array</span><span class="p">):</span>
        <span class="n">vals</span><span class="p">[</span><span class="n">prev_val_iter</span><span class="p">:</span><span class="n">prev_val_iter</span><span class="o">+</span><span class="n">num_vals</span><span class="p">]</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">)</span>
        <span class="n">prev_val_iter</span> <span class="o">+=</span> <span class="n">num_vals</span>
    
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span> <span class="c1"># randomly shuffle order</span>
    
    <span class="k">if</span> <span class="n">path_to_save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">tools</span><span class="o">.</span><span class="n">pickle_data</span><span class="p">(</span><span class="n">path_to_save</span><span class="p">,</span> <span class="n">vals</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">vals</span></div>


<div class="viewcode-block" id="gen_discrete_prob_dist"><a class="viewcode-back" href="../../../../../trafpy.generator.src.dists.html#trafpy.generator.src.dists.val_dists.gen_discrete_prob_dist">[docs]</a><span class="k">def</span> <span class="nf">gen_discrete_prob_dist</span><span class="p">(</span><span class="n">rand_vars</span><span class="p">,</span> 
                           <span class="n">round_to_nearest</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                           <span class="n">num_decimal_places</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                           <span class="n">path_to_save</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Generate discrete probability distribution from list of random variables.</span>

<span class="sd">    Takes rand var values, rounds to nearest value (specified as arg, defaults</span>
<span class="sd">    by not rounding at all) to discretise the data, and generates a </span>
<span class="sd">    probability distribution for the data</span>

<span class="sd">    Args:</span>
<span class="sd">        rand_vars (list): Random variable values</span>
<span class="sd">        round_to_nearest(int/float): Value to round rand vars to nearest when</span>
<span class="sd">            discretising rand var values. E.g. is round_to_nearest=0.2, will round each</span>
<span class="sd">            rand var to nearest 0.2</span>
<span class="sd">        num_decimal_places (int): Number of decimal places for discretised rand vars.</span>
<span class="sd">            Need to explitly state this because otherwise Python&#39;s floating point </span>
<span class="sd">            arithmetic will cause spurious unique random var values</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: Tuple containing:</span>
<span class="sd">            - **xk** (*list*): List of (discretised) unique random variable values </span>
<span class="sd">              that occurred</span>
<span class="sd">            - **pmf** (*list*): List of corresponding probabilities that each</span>
<span class="sd">              unique value in xk occurs</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">round_to_nearest</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># discretise vars</span>
        <span class="n">discretised_rand_vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_round</span><span class="p">(</span><span class="n">rand_var</span><span class="p">,</span><span class="n">round_to_nearest</span><span class="p">,</span><span class="n">num_decimal_places</span><span class="p">,</span><span class="n">print_data</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">rand_var</span> <span class="ow">in</span> <span class="n">rand_vars</span><span class="p">]</span>  
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># no further discretisation required</span>
        <span class="n">discretised_rand_vars</span> <span class="o">=</span> <span class="n">rand_vars</span>

    <span class="c1"># count number of times each var occurs in data</span>
    <span class="n">counter_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">discretised_rand_vars</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">counter_dict</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="c1"># not yet encountered var val</span>
            <span class="n">counter_dict</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="c1"># convert counts to probabilities for each unique var</span>
    <span class="n">total_num_vars</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rand_vars</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">unique_var</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">counter_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">counter_dict</span><span class="p">[</span><span class="n">unique_var</span><span class="p">]</span> <span class="o">/=</span> <span class="n">total_num_vars</span>

    <span class="c1"># ensure all probabilities sum to 1</span>
    <span class="n">total_sum</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">counter_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())),</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">total_sum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> \
            <span class="s1">&#39;probabilities must sum to 1, but is </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">total_sum</span><span class="p">)</span>

    <span class="c1"># gen probability distribution</span>
    <span class="n">prob_dist</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">rv_discrete</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">counter_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="nb">list</span><span class="p">(</span><span class="n">counter_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())))</span>
    <span class="n">xk</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">counter_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">pmf</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">counter_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    
    <span class="k">if</span> <span class="n">path_to_save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">tools</span><span class="o">.</span><span class="n">pickle_data</span><span class="p">(</span><span class="n">path_to_save</span><span class="p">,</span> <span class="n">prob_dist</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">xk</span><span class="p">,</span> <span class="n">pmf</span></div>


<div class="viewcode-block" id="gen_exponential_dist"><a class="viewcode-back" href="../../../../../trafpy.generator.src.dists.html#trafpy.generator.src.dists.val_dists.gen_exponential_dist">[docs]</a><span class="k">def</span> <span class="nf">gen_exponential_dist</span><span class="p">(</span><span class="n">_beta</span><span class="p">,</span> 
                         <span class="n">size</span><span class="p">,</span>
                         <span class="n">interactive_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">logscale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                         <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Generates an exponential distribution of random variable values.</span>
<span class="sd">    </span>
<span class="sd">    The exponential distribution often fits scenarios whose events&#39; random </span>
<span class="sd">    variable values (e.g. &#39;time between events&#39;) are made of many small </span>
<span class="sd">    values (e.g. time intervals) and a few large values. Often used to predict</span>
<span class="sd">    time until next event occurs.</span>

<span class="sd">    E.g. Real-world scenarios: Time between earthquakes, car accidents, mail</span>
<span class="sd">    delivery, and data centre demand arrival.</span>

<span class="sd">    Args:</span>
<span class="sd">        _beta (int/float): Mean random variable value.</span>
<span class="sd">        size (int): Number of random variable values to sample from distribution.</span>
<span class="sd">        interactive_params (dict): Dictionary of distribution parameter values</span>
<span class="sd">            (must provide if in interactive mode).</span>
<span class="sd">        logscale (bool): Whether or not plot should have logscale x-axis and bins.</span>
<span class="sd">        transparent (bool): Whether or not to make plot bins slightly transparent.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: Random variable values generated by sampling from the distribution.</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">rand_vars</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="n">_beta</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">interactive_params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># gen interactive plot</span>
        <span class="n">data_description</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">rand_vars</span><span class="p">)</span> 
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Characteristics of generated distribution:</span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data_description</span><span class="p">))</span>
        
        <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_dist</span><span class="p">(</span><span class="n">rand_vars</span><span class="p">,</span> 
                                 <span class="n">xlim</span><span class="o">=</span><span class="n">interactive_params</span><span class="p">[</span><span class="s1">&#39;xlim&#39;</span><span class="p">],</span> 
                                 <span class="n">logscale</span><span class="o">=</span><span class="n">logscale</span><span class="p">,</span>
                                 <span class="n">transparent</span><span class="o">=</span><span class="n">transparent</span><span class="p">,</span>
                                 <span class="n">dist_fit_line</span><span class="o">=</span><span class="s1">&#39;exponential&#39;</span><span class="p">,</span> 
                                 <span class="n">rand_var_name</span><span class="o">=</span><span class="n">interactive_params</span><span class="p">[</span><span class="s1">&#39;rand_var_name&#39;</span><span class="p">],</span>
                                 <span class="n">prob_rand_var_less_than</span><span class="o">=</span><span class="n">interactive_params</span><span class="p">[</span><span class="s1">&#39;prob_rand_var_less_than&#39;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">rand_vars</span></div>


<div class="viewcode-block" id="gen_lognormal_dist"><a class="viewcode-back" href="../../../../../trafpy.generator.src.dists.html#trafpy.generator.src.dists.val_dists.gen_lognormal_dist">[docs]</a><span class="k">def</span> <span class="nf">gen_lognormal_dist</span><span class="p">(</span><span class="n">_mu</span><span class="p">,</span> 
                       <span class="n">_sigma</span><span class="p">,</span> 
                       <span class="n">size</span><span class="p">,</span> 
                       <span class="n">interactive_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                       <span class="n">logscale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                       <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Generates a log-normal distribution of random variable values.</span>

<span class="sd">    Log-normal distributions often fit scenarios whose random variable values</span>
<span class="sd">    have a low mean value but a high degree of variance, leading to a distribution</span>
<span class="sd">    that is positively skewed (i.e. has a long tail to the right of its peak).</span>

<span class="sd">    The log-normal distribution is mathematically similar to the normal distribution,</span>
<span class="sd">    since its random variable is notmally distributed when its logarithm is taken. </span>
<span class="sd">    I.e. for a log-normally distributed random variable X, Y=ln(X) would have a</span>
<span class="sd">    normal distribution.</span>

<span class="sd">    E.g. of real-world scenarios: Length of a chess game, number of hospitalisations</span>
<span class="sd">    during an epidemic, the time after which a mechanical system needs repair, </span>
<span class="sd">    data centre demand interarrival times, etc.</span>

<span class="sd">    Args:</span>
<span class="sd">        _mu (int/float): Mean value of underlying normal distribution.</span>
<span class="sd">        _sigma (int/float): Standard deviation of underlying normal distribution.</span>
<span class="sd">        size (int): Number of random variable values to sample from distribution.</span>
<span class="sd">        interactive_params (dict): Dictionary of distribution parameter values</span>
<span class="sd">            (must provide if in interactive mode).</span>
<span class="sd">        logscale (bool): Whether or not plot should have logscale x-axis and bins.</span>
<span class="sd">        transparent (bool): Whether or not to make plot bins slightly transparent.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: Random variable values generated by sampling from the distribution.</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">rand_vars</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">lognorm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="n">_sigma</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">_mu</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">interactive_params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># gen interactive plot</span>
        <span class="n">data_description</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">rand_vars</span><span class="p">)</span> 
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Characteristics of generated distribution:</span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data_description</span><span class="p">))</span>
        
        <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_dist</span><span class="p">(</span><span class="n">rand_vars</span><span class="p">,</span> 
                                 <span class="n">xlim</span><span class="o">=</span><span class="n">interactive_params</span><span class="p">[</span><span class="s1">&#39;xlim&#39;</span><span class="p">],</span> 
                                 <span class="n">logscale</span><span class="o">=</span><span class="n">logscale</span><span class="p">,</span>
                                 <span class="n">transparent</span><span class="o">=</span><span class="n">transparent</span><span class="p">,</span>
                                 <span class="n">dist_fit_line</span><span class="o">=</span><span class="s1">&#39;lognormal&#39;</span><span class="p">,</span>
                                 <span class="n">rand_var_name</span><span class="o">=</span><span class="n">interactive_params</span><span class="p">[</span><span class="s1">&#39;rand_var_name&#39;</span><span class="p">],</span>
                                 <span class="n">prob_rand_var_less_than</span><span class="o">=</span><span class="n">interactive_params</span><span class="p">[</span><span class="s1">&#39;prob_rand_var_less_than&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">rand_vars</span></div>


<div class="viewcode-block" id="gen_pareto_dist"><a class="viewcode-back" href="../../../../../trafpy.generator.src.dists.html#trafpy.generator.src.dists.val_dists.gen_pareto_dist">[docs]</a><span class="k">def</span> <span class="nf">gen_pareto_dist</span><span class="p">(</span><span class="n">_alpha</span><span class="p">,</span> 
                    <span class="n">_mode</span><span class="p">,</span>  
                    <span class="n">size</span><span class="p">,</span> 
                    <span class="n">interactive_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">logscale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Generates a pareto distribution of random variable values.</span>

<span class="sd">    Pareto distributions often fit scenarios whose random variable values</span>
<span class="sd">    have high probability of having a small range of values, leading to a </span>
<span class="sd">    distribution that is heavily skewed (i.e. has a long tail).</span>

<span class="sd">    E.g. real-world scenarios: A large portion of society&#39;s wealth being held</span>
<span class="sd">    by a small portion of its population, human settlement sizes, value of</span>
<span class="sd">    oil reserves in oil fields, size of sand particles, male dating success</span>
<span class="sd">    on Tinder, sizes of data centre demands, etc.</span>

<span class="sd">    Args:</span>
<span class="sd">        _alpha (int/float): Shape parameter of Pareto distribution. Describes</span>
<span class="sd">            how &#39;stretched out&#39; (i.e. how high variance) the distribution is.</span>
<span class="sd">        _mode (int/float): Mode of the distribution, which is also the distribution&#39;s</span>
<span class="sd">            minimum possible value. </span>
<span class="sd">        size (int): number of random variable values to sample from distribution.</span>
<span class="sd">        interactive_params (dict): Dictionary of distribution parameter values</span>
<span class="sd">            (must provide if in interactive mode).</span>
<span class="sd">        logscale (bool): Whether or not plot should have logscale x-axis and bins.</span>
<span class="sd">        transparent (bool): Whether or not to make plot bins slightly transparent.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        list: random variable values generated by sampling from the distribution.</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">rand_vars</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">pareto</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="n">_alpha</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">_mode</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">interactive_params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># gen interactive plot</span>
        <span class="n">data_description</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">rand_vars</span><span class="p">)</span> 
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Characteristics of generated distribution:</span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data_description</span><span class="p">))</span>
        
        <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_dist</span><span class="p">(</span><span class="n">rand_vars</span><span class="p">,</span> 
                                 <span class="n">xlim</span><span class="o">=</span><span class="n">interactive_params</span><span class="p">[</span><span class="s1">&#39;xlim&#39;</span><span class="p">],</span> 
                                 <span class="n">logscale</span><span class="o">=</span><span class="n">logscale</span><span class="p">,</span>
                                 <span class="n">transparent</span><span class="o">=</span><span class="n">transparent</span><span class="p">,</span>
                                 <span class="n">dist_fit_line</span><span class="o">=</span><span class="s1">&#39;pareto&#39;</span><span class="p">,</span> 
                                 <span class="n">rand_var_name</span><span class="o">=</span><span class="n">interactive_params</span><span class="p">[</span><span class="s1">&#39;rand_var_name&#39;</span><span class="p">],</span>
                                 <span class="n">prob_rand_var_less_than</span><span class="o">=</span><span class="n">interactive_params</span><span class="p">[</span><span class="s1">&#39;prob_rand_var_less_than&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">rand_vars</span></div>


<div class="viewcode-block" id="gen_weibull_dist"><a class="viewcode-back" href="../../../../../trafpy.generator.src.dists.html#trafpy.generator.src.dists.val_dists.gen_weibull_dist">[docs]</a><span class="k">def</span> <span class="nf">gen_weibull_dist</span><span class="p">(</span><span class="n">_alpha</span><span class="p">,</span> 
                     <span class="n">_lambda</span><span class="p">,</span> 
                     <span class="n">size</span><span class="p">,</span> 
                     <span class="n">interactive_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                     <span class="n">logscale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                     <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Generates a Weibull distribution of random variable values.</span>

<span class="sd">    Weibull distributions often fir scenarios whose random variable values </span>
<span class="sd">    (e.g. &#39;time until failure&#39;) are modelled by &#39;extreme value theory&#39; (EVT) in</span>
<span class="sd">    that the values being predicted are more extreme than any previously recorded</span>
<span class="sd">    and, similar to the log-normal distribution, have a low mean but high variance</span>
<span class="sd">    and therefore a long tail/positive skew. Often use to predict time until</span>
<span class="sd">    failure.</span>

<span class="sd">    E.g. real-world scenarios: Paricle sizes generated by grinding, milling &amp; </span>
<span class="sd">    crushing operations, survival times after cancer diagnosis, light bulb </span>
<span class="sd">    failure times, divorce rates, data centre arrival times, etc.</span>

<span class="sd">    Args:</span>
<span class="sd">        _alpha (int/float): Shape parameter. Describes slope of distribution.</span>
<span class="sd">        </span>
<span class="sd">            _alpha &lt; 1: Probability of random variable occurring decreases as </span>
<span class="sd">            values get higher. Occurs in systems with high &#39;infant mortality&#39;</span>
<span class="sd">            in that e.g. defective items occur soon after t=0 and are therefore</span>
<span class="sd">            weeded out of the population early on.</span>

<span class="sd">            _alpha == 1: Special case of the Weibull distribution which reduces </span>
<span class="sd">            the distribution to an exponential distribution.</span>

<span class="sd">            _alpha &gt; 1: Probability of random variable value occurring increases</span>
<span class="sd">            with time (until peak passes). Occurs in systems with an &#39;aging&#39;</span>
<span class="sd">            process whereby e.g. components are more likely to fail as time goes </span>
<span class="sd">            on.</span>
<span class="sd">        _lambda (int/float): Weibull scale parameter. Use to shape distribution</span>
<span class="sd">            standard deviation.</span>
<span class="sd">        size (int): Number of random variable values to sample from distribution.</span>
<span class="sd">        interactive_params (dict): Dictionary of distribution parameter values</span>
<span class="sd">            (must provide if in interactive mode).</span>
<span class="sd">        logscale (bool): Whether or not plot should have logscale x-axis and bins.</span>
<span class="sd">        transparent (bool): Whether or not to make plot bins slightly transparent.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        list: random variable values generated by sampling from the distribution.</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">rand_vars</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">weibull</span><span class="p">(</span><span class="n">_alpha</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">))</span> <span class="o">*</span> <span class="n">_lambda</span>

    <span class="k">if</span> <span class="n">interactive_params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># gen interactive plot</span>
        <span class="n">data_description</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">rand_vars</span><span class="p">)</span> 
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Characteristics of generated distribution:</span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data_description</span><span class="p">))</span>
        
        <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_dist</span><span class="p">(</span><span class="n">rand_vars</span><span class="p">,</span> 
                                 <span class="n">xlim</span><span class="o">=</span><span class="n">interactive_params</span><span class="p">[</span><span class="s1">&#39;xlim&#39;</span><span class="p">],</span> 
                                 <span class="n">logscale</span><span class="o">=</span><span class="n">logscale</span><span class="p">,</span>
                                 <span class="n">transparent</span><span class="o">=</span><span class="n">transparent</span><span class="p">,</span>
                                 <span class="n">dist_fit_line</span><span class="o">=</span><span class="s1">&#39;weibull&#39;</span><span class="p">,</span> 
                                 <span class="n">rand_var_name</span><span class="o">=</span><span class="n">interactive_params</span><span class="p">[</span><span class="s1">&#39;rand_var_name&#39;</span><span class="p">],</span>
                                 <span class="n">prob_rand_var_less_than</span><span class="o">=</span><span class="n">interactive_params</span><span class="p">[</span><span class="s1">&#39;prob_rand_var_less_than&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">rand_vars</span></div>


<div class="viewcode-block" id="gen_named_val_dist"><a class="viewcode-back" href="../../../../../trafpy.generator.src.dists.html#trafpy.generator.src.dists.val_dists.gen_named_val_dist">[docs]</a><span class="k">def</span> <span class="nf">gen_named_val_dist</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> 
                       <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                       <span class="n">interactive_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">size</span><span class="o">=</span><span class="mi">30000</span><span class="p">,</span> 
                       <span class="n">occurrence_multiplier</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                       <span class="n">return_data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                       <span class="n">round_to_nearest</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                       <span class="n">path_to_save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">plot_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">show_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">logscale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">rand_var_name</span><span class="o">=</span><span class="s1">&#39;Random Variable&#39;</span><span class="p">,</span>
                       <span class="n">prob_rand_var_less_than</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">num_bins</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                       <span class="n">print_data</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Generates a &#39;named&#39; (e.g. Weibull/exponential/log-normal/Pareto) distribution.</span>

<span class="sd">    Args:</span>
<span class="sd">        dist (str): One of the valid named distributions (e.g. &#39;weibull&#39;, &#39;lognormal&#39;,</span>
<span class="sd">            &#39;pareto&#39;, &#39;exponential&#39;)</span>
<span class="sd">        params (dict): Corresponding parameter arguments of distribution (e.g. for</span>
<span class="sd">            Weibull, params={&#39;_alpha&#39;: 1.4, &#39;_lambda&#39;: 7000}). See individual</span>
<span class="sd">            name distribution function generators for more information.</span>
<span class="sd">        interactive_plot (bool): Whether or not you want to use the interactive</span>
<span class="sd">            functionality of this function in Jupyter notebook to visually</span>
<span class="sd">            shape your named distribution.</span>
<span class="sd">        size (int): Number of values to sample from generated distribution when</span>
<span class="sd">            generating random variable data.</span>
<span class="sd">        round_to_nearest (int/float): Value to round random variables to nearest.</span>
<span class="sd">            E.g. if round_to_nearest=0.2, will round each random variable to </span>
<span class="sd">            nearest 0.2.</span>
<span class="sd">        num_decimal_places (int): Number of decimal places to random variable</span>
<span class="sd">            values. Need to explicitly state otherwise Python&#39;s floating point </span>
<span class="sd">            arithmetic will cause spurious unique random variable value errors</span>
<span class="sd">            when discretising.</span>
<span class="sd">        occurrence_multiplier (int/float): When sampling random variables from</span>
<span class="sd">            distribution to create plot and random variable data, use this</span>
<span class="sd">            multiplier to determine number of data points to sample. A higher </span>
<span class="sd">            value will cause the random variable data to match the probability</span>
<span class="sd">            distribution more closely, but will take longer to generate.</span>
<span class="sd">        path_to_save (str): Path to directory (with file name included) in which</span>
<span class="sd">            to save generated distribution. E.g. path_to_save=&#39;data/dists/my_dist&#39;.</span>
<span class="sd">        plot_fig (bool): Whether or not to plot fig. If True, will return fig.</span>
<span class="sd">        show_fig (bool): Whether or not to plot and show fig. If True, will</span>
<span class="sd">            return and display fig.</span>
<span class="sd">        return_data (bool) Whether or not to return random variable data sampled</span>
<span class="sd">            from generated distribution.</span>
<span class="sd">        xlim (list): X-axis limits of plot. E.g. xlim=[0,10] to plot random</span>
<span class="sd">            variable values between 0 and 10.</span>
<span class="sd">        logscale (bool): Whether or not plot should have logscale x-axis and bins.</span>
<span class="sd">        rand_var_name (str): Name of random variable to label plot&#39;s x-axis.</span>
<span class="sd">        prob_rand_var_less_than (list): List of values for which to print the</span>
<span class="sd">            probability that a variable sampled randomly from the generated </span>
<span class="sd">            distribution will be less than. This is useful for replicating </span>
<span class="sd">            distributions from the literature. E.g. prob_rand_var_less_than=[3.7,5.8]</span>
<span class="sd">            will return the probability that a randomly chosen variable is less</span>
<span class="sd">            than 3.7 and 5.8 respectively.</span>
<span class="sd">        num_bins (int): Number of bins to use in plot. Default is 0, in which</span>
<span class="sd">            case the number of bins chosen will be automatically selected.</span>
<span class="sd">        print_data (bool): Whether or not to print extra information about the</span>
<span class="sd">            generated data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: Tuple containing:</span>
<span class="sd">            - **prob_dist** (*dict*): Probability distribution whose key-value pairs are </span>
<span class="sd">              random variable value-probability pairs. </span>
<span class="sd">            - **rand_vars** (*list, optional*): Random variable values sampled from the </span>
<span class="sd">              generated probability distribution. To return, set return_data=True.</span>
<span class="sd">            - **fig** (*matplotlib.figure.Figure, optional*): Probability density </span>
<span class="sd">              and cumulative distribution function plot. To return, set show_fig=True </span>
<span class="sd">              and/or plot_fig=True.</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">interactive_plot</span> <span class="o">==</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;if not using interactive, provide params dict&#39;</span>
        <span class="n">show_fig</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># dont show standard fig, only interactive</span>
        <span class="c1"># num_bins_widget = widgets.IntText(description=&#39;bins:&#39;,value=0,step=1,disabled=False)</span>
    <span class="k">if</span> <span class="n">params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">interactive_plot</span> <span class="o">==</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;cannot provide params dict if using interactive&#39;</span>

    <span class="k">if</span> <span class="n">dist</span> <span class="o">==</span> <span class="s1">&#39;exponential&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">interactive_plot</span><span class="p">:</span>
            <span class="n">_beta_exp_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatText</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;_beta:&#39;</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">rand_vars</span> <span class="o">=</span> <span class="n">interactive</span><span class="p">(</span><span class="n">gen_exponential_dist</span><span class="p">,</span>
                                    <span class="p">{</span><span class="s1">&#39;manual&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
                                    <span class="n">_beta</span><span class="o">=</span><span class="n">_beta_exp_widget</span><span class="p">,</span>
                                    <span class="n">size</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="n">size</span><span class="p">),</span>
                                    <span class="n">interactive_params</span><span class="o">=</span><span class="n">fixed</span><span class="p">({</span><span class="s1">&#39;xlim&#39;</span><span class="p">:</span> <span class="n">xlim</span><span class="p">,</span> 
                                                              <span class="s1">&#39;rand_var_name&#39;</span><span class="p">:</span> <span class="n">rand_var_name</span><span class="p">,</span>
                                                              <span class="s1">&#39;prob_rand_var_less_than&#39;</span><span class="p">:</span> <span class="n">prob_rand_var_less_than</span><span class="p">,</span>
                                                              <span class="s1">&#39;num_bins&#39;</span><span class="p">:</span> <span class="n">num_bins</span><span class="p">}))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rand_vars</span> <span class="o">=</span> <span class="n">gen_exponential_dist</span><span class="p">(</span><span class="n">_beta</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;_beta&#39;</span><span class="p">],</span> 
                                             <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">dist</span> <span class="o">==</span> <span class="s1">&#39;lognormal&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">interactive_plot</span><span class="p">:</span>
            <span class="n">_mu_lognormal_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatText</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;_mu:&#39;</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span><span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">_sigma_lognormal_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatText</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;_sigma:&#39;</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">rand_vars</span> <span class="o">=</span> <span class="n">interactive</span><span class="p">(</span><span class="n">gen_lognormal_dist</span><span class="p">,</span>
                                    <span class="p">{</span><span class="s1">&#39;manual&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
                                    <span class="n">_mu</span><span class="o">=</span><span class="n">_mu_lognormal_widget</span><span class="p">,</span>
                                    <span class="n">_sigma</span><span class="o">=</span><span class="n">_sigma_lognormal_widget</span><span class="p">,</span>
                                    <span class="n">size</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="n">size</span><span class="p">),</span>
                                    <span class="n">interactive_params</span><span class="o">=</span><span class="n">fixed</span><span class="p">({</span><span class="s1">&#39;xlim&#39;</span><span class="p">:</span> <span class="n">xlim</span><span class="p">,</span> 
                                                              <span class="s1">&#39;rand_var_name&#39;</span><span class="p">:</span> <span class="n">rand_var_name</span><span class="p">,</span>
                                                              <span class="s1">&#39;prob_rand_var_less_than&#39;</span><span class="p">:</span> <span class="n">prob_rand_var_less_than</span><span class="p">,</span>
                                                              <span class="s1">&#39;num_bins&#39;</span><span class="p">:</span> <span class="n">num_bins</span><span class="p">}))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rand_vars</span> <span class="o">=</span> <span class="n">gen_lognormal_dist</span><span class="p">(</span><span class="n">_mu</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;_mu&#39;</span><span class="p">],</span>
                                           <span class="n">_sigma</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;_sigma&#39;</span><span class="p">],</span>
                                           <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">dist</span> <span class="o">==</span> <span class="s1">&#39;weibull&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">interactive_plot</span><span class="p">:</span>
            <span class="n">_alpha_weibull_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatText</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;_alpha:&#39;</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">_lambda_weibull_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatText</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;_lambda:&#39;</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">rand_vars</span> <span class="o">=</span> <span class="n">interactive</span><span class="p">(</span><span class="n">gen_weibull_dist</span><span class="p">,</span>
                                    <span class="p">{</span><span class="s1">&#39;manual&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
                                    <span class="n">_alpha</span><span class="o">=</span><span class="n">_alpha_weibull_widget</span><span class="p">,</span>
                                    <span class="n">_lambda</span><span class="o">=</span><span class="n">_lambda_weibull_widget</span><span class="p">,</span>
                                    <span class="n">size</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="n">size</span><span class="p">),</span>
                                    <span class="n">interactive_params</span><span class="o">=</span><span class="n">fixed</span><span class="p">({</span><span class="s1">&#39;xlim&#39;</span><span class="p">:</span> <span class="n">xlim</span><span class="p">,</span> 
                                                              <span class="s1">&#39;rand_var_name&#39;</span><span class="p">:</span> <span class="n">rand_var_name</span><span class="p">,</span>
                                                              <span class="s1">&#39;prob_rand_var_less_than&#39;</span><span class="p">:</span> <span class="n">prob_rand_var_less_than</span><span class="p">,</span>
                                                              <span class="s1">&#39;num_bins&#39;</span><span class="p">:</span> <span class="n">num_bins</span><span class="p">}))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rand_vars</span> <span class="o">=</span> <span class="n">gen_weibull_dist</span><span class="p">(</span><span class="n">_alpha</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;_alpha&#39;</span><span class="p">],</span>
                                         <span class="n">_lambda</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;_lambda&#39;</span><span class="p">],</span>
                                         <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">dist</span> <span class="o">==</span> <span class="s1">&#39;pareto&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">interactive_plot</span><span class="p">:</span>
            <span class="n">_alpha_pareto_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatText</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;_alpha:&#39;</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span><span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">_mode_pareto_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatText</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;_mode:&#39;</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">rand_vars</span> <span class="o">=</span> <span class="n">interactive</span><span class="p">(</span><span class="n">gen_pareto_dist</span><span class="p">,</span>
                                    <span class="p">{</span><span class="s1">&#39;manual&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
                                    <span class="n">_alpha</span><span class="o">=</span><span class="n">_alpha_pareto_widget</span><span class="p">,</span>
                                    <span class="n">_mode</span><span class="o">=</span><span class="n">_mode_pareto_widget</span><span class="p">,</span>
                                    <span class="n">size</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="n">size</span><span class="p">),</span>
                                    <span class="n">interactive_params</span><span class="o">=</span><span class="n">fixed</span><span class="p">({</span><span class="s1">&#39;xlim&#39;</span><span class="p">:</span> <span class="n">xlim</span><span class="p">,</span> 
                                                              <span class="s1">&#39;rand_var_name&#39;</span><span class="p">:</span> <span class="n">rand_var_name</span><span class="p">,</span>
                                                              <span class="s1">&#39;prob_rand_var_less_than&#39;</span><span class="p">:</span> <span class="n">prob_rand_var_less_than</span><span class="p">,</span>
                                                              <span class="s1">&#39;num_bins&#39;</span><span class="p">:</span> <span class="n">num_bins</span><span class="p">}))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rand_vars</span> <span class="o">=</span> <span class="n">gen_pareto_dist</span><span class="p">(</span><span class="n">_alpha</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;_alpha&#39;</span><span class="p">],</span>
                                        <span class="n">_mode</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;_mode&#39;</span><span class="p">],</span>
                                        <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exist</span><span class="p">(</span><span class="s1">&#39;Must provide valid name distribution to use&#39;</span><span class="p">)</span>
   
    <span class="k">if</span> <span class="n">interactive_plot</span><span class="p">:</span>
        <span class="n">display</span><span class="p">(</span><span class="n">rand_vars</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rand_vars</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">unique_vals</span><span class="p">,</span> <span class="n">pmf</span> <span class="o">=</span> <span class="n">gen_discrete_prob_dist</span><span class="p">(</span><span class="n">rand_vars</span><span class="p">,</span>
                                                  <span class="n">round_to_nearest</span><span class="o">=</span><span class="n">round_to_nearest</span><span class="p">)</span>
        <span class="n">prob_dist</span> <span class="o">=</span> <span class="p">{</span><span class="n">unique_var</span><span class="p">:</span> <span class="n">prob</span> <span class="k">for</span> <span class="n">unique_var</span><span class="p">,</span> <span class="n">prob</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">unique_vals</span><span class="p">,</span> <span class="n">pmf</span><span class="p">)}</span>

        <span class="k">if</span> <span class="n">print_data</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Prob dist:</span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prob_dist</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">path_to_save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tools</span><span class="o">.</span><span class="n">pickle_data</span><span class="p">(</span><span class="n">path_to_save</span><span class="p">,</span> <span class="n">node_dist</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">plot_fig</span> <span class="ow">or</span> <span class="n">show_fig</span><span class="p">:</span>
            <span class="n">min_prob</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">prob</span> <span class="k">for</span> <span class="n">prob</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">prob_dist</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="k">if</span> <span class="n">prob</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">num_occurrences</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">min_prob</span><span class="p">)</span><span class="o">*</span><span class="n">occurrence_multiplier</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">prob_dist</span><span class="o">.</span><span class="n">values</span><span class="p">())]</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">convert_key_occurrences_to_data</span><span class="p">(</span><span class="n">unique_vals</span><span class="p">,</span><span class="n">num_occurrences</span><span class="p">)</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_dists</span><span class="o">.</span><span class="n">plot_val_dist</span><span class="p">(</span><span class="n">rand_vars</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> 
                                           <span class="n">xlim</span><span class="o">=</span><span class="n">xlim</span><span class="p">,</span>
                                           <span class="n">logscale</span><span class="o">=</span><span class="n">logscale</span><span class="p">,</span>
                                           <span class="n">rand_var_name</span><span class="o">=</span><span class="n">rand_var_name</span><span class="p">,</span>
                                           <span class="n">prob_rand_var_less_than</span><span class="o">=</span><span class="n">prob_rand_var_less_than</span><span class="p">,</span>
                                           <span class="n">num_bins</span><span class="o">=</span><span class="n">num_bins</span><span class="p">,</span>
                                           <span class="n">show_fig</span><span class="o">=</span><span class="n">show_fig</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">return_data</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">prob_dist</span><span class="p">,</span> <span class="n">rand_vars</span><span class="p">,</span> <span class="n">fig</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">prob_dist</span><span class="p">,</span> <span class="n">fig</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">return_data</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">prob_dist</span><span class="p">,</span> <span class="n">rand_vars</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">prob_dist</span></div>


















</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Christopher W. F. Parsonson

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>